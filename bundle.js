(()=>{"use strict";class e{constructor(e,t,l){this.length=e,this.hits=[],this.position=l||[],this.column=t||[]}hit(e){this.position.includes(e)&&!this.hits.includes(e)&&this.hits.push(e)}isSunk(){return this.length===this.hits.length}}const t=(e,t,l,r)=>{const a=document.querySelector(t);let i=e.board;console.log(i),i.forEach((e=>{e.forEach((e=>{const t=document.createElement("div");t.classList.add(l),t.classList.add(r),t.setAttribute("value",e),a.appendChild(t),t.value=e,t.textContent=e}))}))},l=(e,t,l,a)=>{r(t,l);const i=document.querySelector(`#${t}`);e.board.forEach((e=>{e.forEach((e=>{const t=document.createElement("div");t.classList.add(l),t.classList.add(a),t.setAttribute("value",e),i.appendChild(t),t.value=e,t.textContent=e}))}))},r=(e,t)=>{const l=document.querySelector(`#${e}`);document.querySelectorAll(`.${t}`).forEach((e=>{l.removeChild(e)}))},a=(e,t,l)=>{let r=[6,7,8,9],a=[7,8,9],i=[8,9],n=[9];if(1===l)switch(!0){case 5===e.length&&r.includes(t.target.value%10):case 4===e.length&&a.includes(t.target.value%10):case 3===e.length&&i.includes(t.target.value%10):case 2===e.length&&n.includes(t.target.value%10):return!0}if(10===l)switch(!0){case 5===e.length&&r.includes(Math.floor(t.target.value/10)):case 4===e.length&&a.includes(Math.floor(t.target.value/10)):case 3===e.length&&i.includes(Math.floor(t.target.value/10)):case 2===e.length&&n.includes(Math.floor(t.target.value/10)):return!0}},i=(e,t,l,r)=>{let i=[];if(1!==e.length){for(let n=0;n<=(e.length-1)*r;n+=r){if(a(e,t,r))return;if(5===e.length&&t.target.value%10==6)return;if(t.target.value+n=="x0")return;if(null===document.querySelector(`div[value="${t.target.value+n}"]`))return;if(t.target.value+n=="x0")return;document.querySelector(`div[value="${t.target.value+n}"]`).style.backgroundColor=l,i.push(t.target.value+n)}return i}};let n=!0,o="horizontal",s=1;const u=document.querySelector("#rotate"),c=(t,r)=>{let a=document.querySelectorAll(`.player-grids.${o}`);const u=new e(r,[0,0,0],[1,2,3]);3===r&&n&&(r+=1,n=!1),r<=0||(a.forEach((e=>e.addEventListener("mouseover",(a=>{i(u,a,"blue",s),e.addEventListener("click",(e=>{u.position=i(u,e,"gray",s),u.column=(e=>{let t=[];for(let l=0;l<=e.length-1;l++)e.position[l]&&t.push(Math.floor(e.position[l]/10));return t})(u),t.placeShip(u),l(t,"primary-container","player-grids",o),Array.from(document.querySelectorAll(".player-grids")).filter((e=>"x"===e.value)).forEach((e=>e.style.backgroundColor="transparent")),c(t,r-1)}))})))),a.forEach((e=>e.addEventListener("mouseout",(e=>{i(u,e,"gray",s)})))))};u.addEventListener("click",(e=>{"horizontal"===o?(o="vertical",s=10):"vertical"===o&&(o="horizontal",s=1)}));class h{constructor(e){this.board=e||[],this.missed=[[]],this.hits=[[]]}initialize(e){for(let t=0;t<10;t++){this.board[t]=[];for(let l=0;l<10;l++)this.board[t][l]=e,e++}}placeShip(e){let t=e.column,l=e.position;for(let e=0;e<l.length;e++)for(let r=0;r<l.length;r++)this.board[t[e]][this.board[t[e]].indexOf(l[r])]="x"}checkIfOutOfBound=(e,t)=>{let l=this.ship;if(1===t)switch(!0){case 5===l.length&&outOfBound5.includes(e.target.value%10):case 4===l.length&&outOfBound4.includes(e.target.value%10):case 3===l.length&&outOfBound3.includes(e.target.value%10):case 2===l.length&&outOfBound2.includes(e.target.value%10):return!0}if(10===t)switch(!0){case 5===l.length&&outOfBound5.includes(Math.floor(e.target.value/10)):case 4===l.length&&outOfBound4.includes(Math.floor(e.target.value/10)):case 3===l.length&&outOfBound3.includes(Math.floor(e.target.value/10)):case 2===l.length&&outOfBound2.includes(Math.floor(e.target.value/10)):return}};recieveAttack(e,t){"x"===this.board[e][t]?void 0===this.hits[e]?this.hits[e]=[t]:this.hits[e].push(t):void 0===this.missed[e]?this.missed[e]=[t]:this.missed[e].push(t)}}class d{constructor(){this.turn=!0,this.position=this.position}autoPlay(){return Math.floor(10*Math.random())}}(()=>{new d,new d;const r=new h,a=new h;r.initialize(0),a.initialize(100),t(r,"#primary-container","player-grids","horizontal"),t(a,"#secondary-container","ai-grids","x"),c(r,5),(t=>{const r=new e(5,[0,0,0,0,0],[100,102,103,104,105]),a=new e(4,[7,7,7,7],[173,174,175,176]),i=new e(3,[2,2,2],[122,123,124]),n=new e(3,[4,4,4],[144,145,146]),o=new e(2,[8,9],[181,191]);t.placeShip(r),t.placeShip(a),t.placeShip(i),t.placeShip(n),t.placeShip(o),l(t,"secondary-container","ai-grids")})(a)})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUksTUFDcENxRixFQUFRLElBQUlyRixFQUFLLEVBQUUsQ0FBQyxFQUFFLEVBQUUsR0FBRyxDQUFDLElBQUksSUFBSSxNQUNwQ3NGLEVBQVEsSUFBSXRGLEVBQUssRUFBRSxDQUFDLEVBQUUsR0FBRyxDQUFDLElBQUksTUFFcEM0RCxFQUFVSyxVQUFVeEIsR0FDcEJtQixFQUFVSyxVQUFVa0IsR0FDcEJ2QixFQUFVSyxVQUFVbUIsR0FDcEJ4QixFQUFVSyxVQUFVb0IsR0FDcEJ6QixFQUFVSyxVQUFVcUIsR0FDcEJyRCxFQUFZMkIsRUFBVSxzQkFBc0IsV0FBVyxFR3JQdkQyQixDQUFjTCxFQUFRLEVBZTFCTSxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9mYWN0b3JpZXMvU2hpcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3NjcmlwdHMvZG9tLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZmFjdG9yaWVzL0dhbWVCb2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2ZhY3Rvcmllcy9QbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9zY3JpcHRzL21haW4uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2hpcHtcbiAgICBjb25zdHJ1Y3RvcihsZW5ndGgsY29sdW1uLHBvc2l0aW9uKXtcbiAgICAgICAgdGhpcy5sZW5ndGggPSBsZW5ndGg7XG4gICAgICAgIHRoaXMuaGl0cyA9IFtdO1xuICAgICAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb258fFtdO1xuICAgICAgICB0aGlzLmNvbHVtbiA9IGNvbHVtbnx8W107XG4gICAgICAgXG4gICAgfVxuICAgIGhpdChoaXRQb3NpdGlvbil7XG4gICAgICAgIGlmKHRoaXMucG9zaXRpb24uaW5jbHVkZXMoaGl0UG9zaXRpb24pJiYgISh0aGlzLmhpdHMuaW5jbHVkZXMoaGl0UG9zaXRpb24pKSl7XG4gICAgICAgICAgICB0aGlzLmhpdHMucHVzaChoaXRQb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfVxuXG4gICAgaXNTdW5rKCl7XG4gICAgICAgIGlmKHRoaXMubGVuZ3RoID09PSB0aGlzLmhpdHMubGVuZ3RoKXtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG5cbiIsImltcG9ydCBHYW1lQm9hcmQgZnJvbSBcIi4uL2ZhY3Rvcmllcy9HYW1lQm9hcmRcIjtcbmltcG9ydCBTaGlwIGZyb20gXCIuLi9mYWN0b3JpZXMvU2hpcFwiO1xuXG5cbi8vIFRPRE86IEZpeCBzaGlwIGlzc3VlIHdoZXJlIHNoaXAgcGxhY2VtZW50IG92ZXJsYXBcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZUJvYXJkID0gKG5ld0JvYXJkLGlkLGNsYXNzTmFtZSxkaXJlY3Rpb24pPT57XG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihpZCk7XG4gICAgXG4gICAgbGV0IGJvYXJkID0gbmV3Qm9hcmQuYm9hcmQ7XG4gICAgY29uc29sZS5sb2coYm9hcmQpO1xuICAgIGJvYXJkLmZvckVhY2goZT0+e1xuICAgICAgICBlLmZvckVhY2goZT0+e1xuICAgICAgICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpOyBcbiAgICAgICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKGRpcmVjdGlvbik7IFxuICAgICAgICAgICAgZGl2LnNldEF0dHJpYnV0ZSgndmFsdWUnLGUpO1xuICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGRpdik7XG4gICAgICAgICAgICBkaXYudmFsdWUgPSBlO1xuICAgICAgICAgICAgZGl2LnRleHRDb250ZW50ID0gZTtcbiAgICAgICAgICAgIFxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydCBjb25zdCB1cGRhdGVCb2FyZCA9IChuZXdCb2FyZCxjb250YWluZXJJRCxncmlkSUQsZGlyZWN0aW9uKT0+e1xuICAgIHJlbW92ZUJvYXJkKGNvbnRhaW5lcklELGdyaWRJRCk7XG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7Y29udGFpbmVySUR9YCk7XG4gICAgbGV0IGJvYXJkID0gbmV3Qm9hcmQuYm9hcmQ7XG4gICAgYm9hcmQuZm9yRWFjaChlPT57XG4gICAgICAgIGUuZm9yRWFjaChlPT57XG4gICAgICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKGdyaWRJRCk7IFxuICAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZChkaXJlY3Rpb24pOyBcbiAgICAgICAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJyxlKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChkaXYpO1xuICAgICAgICAgICAgZGl2LnZhbHVlID0gZTtcbiAgICAgICAgICAgIGRpdi50ZXh0Q29udGVudCA9IGU7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIFxuICAgICAgICB9KTtcbiAgICAgICAgIFxuICAgIH0pO1xuXG4gICAgXG59XG5leHBvcnQgY29uc3QgcmVtb3ZlQm9hcmQgPSAoY29udGFpbmVySUQsZ3JpZElEKT0+e1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2NvbnRhaW5lcklEfWApO1xuICAgIGNvbnN0IGdyaWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAuJHtncmlkSUR9YCk7XG4gICAgZ3JpZC5mb3JFYWNoKGVsZW1lbnQ9PiB7IFxuICAgICAgICAgICAgXG4gICAgICAgICBjb250YWluZXIucmVtb3ZlQ2hpbGQoZWxlbWVudClcbiAgICAgIFxuICAgICAgIFxuICAgIH0pO1xufVxuZXhwb3J0IGNvbnN0IGNsaWNrRXZlbnQgPSAocGxheWVyLGFpKT0+e1xuICAgIGNvbnN0IGdyaWRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmdyaWRzJyk7XG4gICAgZ3JpZHMuZm9yRWFjaChlbGVtZW50PT5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSk9PntcbiAgICAgICAgaWYocGxheWVyLnR1cm4pe1xuICAgICAgICAgICAgIGFpLnR1cm4gPSB0cnVlO1xuICAgICAgICAgICAgIHBsYXllci50dXJuID0gZmFsc2U7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdwbGF5ZXI6ICcrZS50YXJnZXQudmFsdWUpO1xuICAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEV2ZW50KCdjbGljaycpO1xuICAgICAgICAgICAgZWxlbWVudC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICAgICAgfWVsc2UgaWYoYWkudHVybil7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnYWk6ICcrIGFpLmF1dG9QbGF5KCkpO1xuICAgICAgICAgICAgYWkudHVybiA9IGZhbHNlO1xuICAgICAgICAgICAgcGxheWVyLnR1cm4gPSB0cnVlO1xuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfSkpO1xufVxuXG5jb25zdCBjaGVja0lmT3V0T2ZCb3VuZCA9IChzaGlwLGV2ZW50LGluY3JlbWVudCk9PntcbiAgICBsZXQgb3V0T2ZCb3VuZDUgPSBbNiw3LDgsOV07XG4gICAgIGxldCBvdXRPZkJvdW5kNCA9IFs3LDgsOV07XG4gICAgIGxldCBvdXRPZkJvdW5kMyA9IFs4LDldO1xuICAgICBsZXQgb3V0T2ZCb3VuZDIgPSBbOV07XG4gICAgXG4gICAgaWYoaW5jcmVtZW50ID09PTEpe1xuICAgICAgICBzd2l0Y2godHJ1ZSl7IFxuICAgICAgICAgICAgIGNhc2Ugc2hpcC5sZW5ndGg9PT01ICYmIG91dE9mQm91bmQ1LmluY2x1ZGVzKGV2ZW50LnRhcmdldC52YWx1ZSUxMCk6XG4gICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgIGNhc2Ugc2hpcC5sZW5ndGg9PT00ICYmIG91dE9mQm91bmQ0LmluY2x1ZGVzKGV2ZW50LnRhcmdldC52YWx1ZSUxMCk6XG4gICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgIGNhc2Ugc2hpcC5sZW5ndGg9PT0zICYmIG91dE9mQm91bmQzLmluY2x1ZGVzKGV2ZW50LnRhcmdldC52YWx1ZSUxMCk6XG4gICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgIGNhc2Ugc2hpcC5sZW5ndGg9PT0yICYmIG91dE9mQm91bmQyLmluY2x1ZGVzKGV2ZW50LnRhcmdldC52YWx1ZSUxMCk6XG4gICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBcbiAgICAgfVxuICAgICBpZihpbmNyZW1lbnQgPT09MTApe1xuICAgICAgICAgc3dpdGNoKHRydWUpeyBcbiAgICAgICAgICAgICAgY2FzZSBzaGlwLmxlbmd0aD09PTUgJiYgb3V0T2ZCb3VuZDUuaW5jbHVkZXMoTWF0aC5mbG9vcihldmVudC50YXJnZXQudmFsdWUvMTApKTpcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09NCAmJiBvdXRPZkJvdW5kNC5pbmNsdWRlcyhNYXRoLmZsb29yKGV2ZW50LnRhcmdldC52YWx1ZS8xMCkpOlxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgIGNhc2Ugc2hpcC5sZW5ndGg9PT0zICYmIG91dE9mQm91bmQzLmluY2x1ZGVzKE1hdGguZmxvb3IoZXZlbnQudGFyZ2V0LnZhbHVlLzEwKSk6XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgY2FzZSBzaGlwLmxlbmd0aD09PTIgJiYgb3V0T2ZCb3VuZDIuaW5jbHVkZXMoTWF0aC5mbG9vcihldmVudC50YXJnZXQudmFsdWUvMTApKTpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgfSBcbiAgICAgIH1cbn1cbmNvbnN0IGdldENvb3JkaW5hdGVzID0gKHNoaXAsZXZlbnQsY29sb3IsaW5jcmVtZW50KT0+e1xuICBcblxuICBsZXQgY29vcmRpbmF0ZSA9IFtdO1xuICBpZiAoc2hpcC5sZW5ndGggPT09IDEpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgZm9yIChsZXQgaSA9IDA7IGkgPD0gKHNoaXAubGVuZ3RoIC0gMSkgKiBpbmNyZW1lbnQ7IGkgPSBpICsgaW5jcmVtZW50KSB7XG4gICAgIGlmKGNoZWNrSWZPdXRPZkJvdW5kKHNoaXAsZXZlbnQsaW5jcmVtZW50KSkgcmV0dXJuO1xuICAgXG4gICAgaWYgKHNoaXAubGVuZ3RoID09PSA1KSB7XG4gICAgICBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlICUgMTAgPT09IDYpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlICsgaSA9PSBcIngwXCIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgZGl2W3ZhbHVlPVwiJHtldmVudC50YXJnZXQudmFsdWUgKyBpfVwiXWApID09PSBudWxsXG4gICAgKSB7XG4gICAgICByZXR1cm47XG4gICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQudmFsdWUgKyBpID09IFwieDBcIikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgZGl2W3ZhbHVlPVwiJHtldmVudC50YXJnZXQudmFsdWUgKyBpfVwiXWBcbiAgICApLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yO1xuICAgIGNvb3JkaW5hdGUucHVzaChldmVudC50YXJnZXQudmFsdWUgKyBpKTtcbiAgfVxuICByZXR1cm4gY29vcmRpbmF0ZTtcbn1cbmNvbnN0IGdldENvbHVtbnMgPSAoc2hpcCk9PntcbiAgICBsZXQgY29sdW1ucyA9IFtdO1xuICAgIGZvcihsZXQgaSA9IDA7IGk8PXNoaXAubGVuZ3RoLTE7IGkrKyl7XG4gICAgICAgIFxuICAgICAgICAgIGlmKHNoaXAucG9zaXRpb25baV0pe1xuICAgICAgICAgICAgIGNvbHVtbnMucHVzaChNYXRoLmZsb29yKChzaGlwLnBvc2l0aW9uW2ldKS8xMCkpO1xuICAgICAgICB9ICBcbiAgICAgICAgXG4gICAgICAgIFxuXG4gICAgICAgXG4gICAgfVxuICBcbiAgICByZXR1cm4gY29sdW1ucztcbn1cbmNvbnN0IGNoYW5nZUNvbG9yID0gKCkgPT57XG4gICAgY29uc3Qgc2VsZWN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGxheWVyLWdyaWRzJykpO1xuICAgIHNlbGVjdC5maWx0ZXIoZWxlbWVudD0+ZWxlbWVudC52YWx1ZT09PSd4JykuZm9yRWFjaChlbGVtZW50PT5lbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd0cmFuc3BhcmVudCcpO1xuICAgIFxuICAgIFxufVxubGV0IGZsYWcgPSB0cnVlO1xuIGxldCBkaXJlY3Rpb24gPSAnaG9yaXpvbnRhbCc7XG4gbGV0IGluY3JlbWVudCA9IDE7XG4gY29uc3Qgcm90YXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3JvdGF0ZScpO1xuXG5leHBvcnQgY29uc3QgcmVuZGVyUGxheWVyU2hpcHMgPSAgKGdhbWVib2FyZCxsZW5ndGgpID0+e1xuICAgIFxuICAgXG4gICAgbGV0IGdyaWRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLnBsYXllci1ncmlkcy4ke2RpcmVjdGlvbn1gKTtcbiAgICBcbiAgICBcbiAgICBjb25zdCBzaGlwID0gbmV3IFNoaXAobGVuZ3RoLFswLDAsMF0sWzEsMiwzXSk7XG4gICAgXG4gICAgaWYobGVuZ3RoPT09Myl7XG4gICAgICAgIGlmKGZsYWcpe1xuICAgICAgICAgICBsZW5ndGgrPTE7IFxuICAgICAgICAgICBmbGFnPWZhbHNlO1xuICAgICAgICB9IFxuICAgIH1cbiAgICBpZihsZW5ndGg8PTApe1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGNoZWNrTmVhclNoaXBzID0oYm9hcmQsc2hpcCk9PntcbiAgICAgICAgbGV0IHBvc2l0aW9uID0gc2hpcC5wb3NpdGlvbjtcbiAgICAgICAgbGV0IGNvbHVtbiA9IHNoaXAuY29sdW1uO1xuICAgICAgICBmb3IobGV0IGkgPTA7IGk8c2hpcC5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgIGZvcihsZXQgaiA9IDA7IGo8c2hpcC5sZW5ndGg7aisrKXtcbiAgICAgICAgICAgICAgICBpZigoYm9hcmQuYm9hcmRbY29sdW1uW2ldXVtwb3NpdGlvbltqXV0pLmVxdWFscygneCcpKXtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgIH0gXG4gICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ3JpZHMuZm9yRWFjaChlbGVtZW50PT5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsKGUpPT57XG4gICAgICAgICAgICAgZ2V0Q29vcmRpbmF0ZXMoc2hpcCxlLCdibHVlJyxpbmNyZW1lbnQpO1xuICAgICAgICAgICAgIFxuICAgICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSk9PntcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICBzaGlwLnBvc2l0aW9uID0gZ2V0Q29vcmRpbmF0ZXMoc2hpcCxlLCdncmF5JyxpbmNyZW1lbnQpO1xuICAgICAgICAgICAgICAgc2hpcC5jb2x1bW4gPSBnZXRDb2x1bW5zKHNoaXApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICBnYW1lYm9hcmQucGxhY2VTaGlwKHNoaXApO1xuICAgICAgICAgICAgICAgICB1cGRhdGVCb2FyZChnYW1lYm9hcmQsJ3ByaW1hcnktY29udGFpbmVyJyxcInBsYXllci1ncmlkc1wiLGRpcmVjdGlvbik7XG4gICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICBjaGFuZ2VDb2xvcigpO1xuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJlbmRlclBsYXllclNoaXBzKGdhbWVib2FyZCxsZW5ndGgtMSk7XG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgIFxuICAgIH0pKTtcbiAgICBcblxuICAgIGdyaWRzLmZvckVhY2goZWxlbWVudD0+ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsKGUpPT57XG4gICAgICAgIGdldENvb3JkaW5hdGVzKHNoaXAsZSwnZ3JheScsaW5jcmVtZW50KTtcbiAgICB9KSk7ICBcbiAgICBcbiAgIFxuICAgXG59XG5cbiByb3RhdGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLChlKT0+e1xuICAgICAgXG4gICAgICAgIGlmKGRpcmVjdGlvbiA9PT0naG9yaXpvbnRhbCcpe1xuICAgICAgICAgICAgZGlyZWN0aW9uID0gJ3ZlcnRpY2FsJztcbiAgICAgICAgICAgIGluY3JlbWVudCA9IDEwO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBcbiAgICAgICAgfWVsc2UgaWYoZGlyZWN0aW9uID09PSd2ZXJ0aWNhbCcpe1xuICAgICAgICAgICAgZGlyZWN0aW9uID0gJ2hvcml6b250YWwnO1xuICAgICAgICAgICAgaW5jcmVtZW50ID0gMTtcbiAgICAgICAgICAgXG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgXG4gICAgfSk7XG5cblxuXG5cblxuZXhwb3J0IGNvbnN0IHJlbmRlckFpU2hpcHMgPSAgKGdhbWVib2FyZCkgPT57XG4gICAgY29uc3Qgc2hpcCA9IG5ldyBTaGlwKDUsWzAsMCwwLDAsMF0sWzEwMCwxMDIsMTAzLDEwNCwxMDVdKTtcbiAgICBjb25zdCBzaGlwMiA9IG5ldyBTaGlwKDQsWzcsNyw3LDddLFsxNzMsMTc0LDE3NSwxNzZdKTtcbiAgICBjb25zdCBzaGlwMyA9IG5ldyBTaGlwKDMsWzIsMiwyXSxbMTIyLDEyMywxMjRdKTtcbiAgICBjb25zdCBzaGlwNCA9IG5ldyBTaGlwKDMsWzQsNCw0XSxbMTQ0LDE0NSwxNDZdKTtcbiAgICBjb25zdCBzaGlwNSA9IG5ldyBTaGlwKDIsWzgsOV0sWzE4MSwxOTFdKTtcbiAgICBcbiAgICBnYW1lYm9hcmQucGxhY2VTaGlwKHNoaXApO1xuICAgIGdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcDIpO1xuICAgIGdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcDMpO1xuICAgIGdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcDQpO1xuICAgIGdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcDUpO1xuICAgIHVwZGF0ZUJvYXJkKGdhbWVib2FyZCwnc2Vjb25kYXJ5LWNvbnRhaW5lcicsXCJhaS1ncmlkc1wiKTtcbn1cblxuXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lQm9hcmQge1xuICBjb25zdHJ1Y3Rvcihib2FyZCkge1xuICAgIHRoaXMuYm9hcmQgPSBib2FyZCB8fCBbXTtcbiAgICB0aGlzLm1pc3NlZCA9IFtbXV07XG4gICAgdGhpcy5oaXRzID0gW1tdXTtcbiAgICBcbiAgfVxuXG4gIGluaXRpYWxpemUoY291bnQpIHtcbiAgICBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgIHRoaXMuYm9hcmRbaV0gPSBbXTtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgICAgICB0aGlzLmJvYXJkW2ldW2pdID0gY291bnQ7XG4gICAgICAgIGNvdW50Kys7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuXG5cbiAgcGxhY2VTaGlwKHNoaXApIHtcbiAgICBsZXQgY29sdW1uID0gc2hpcC5jb2x1bW47XG4gICAgbGV0IHBvc2l0aW9uID0gc2hpcC5wb3NpdGlvbjtcbiAgICBcbiAgIFxuICAgIGZvcihsZXQgaT0wOyBpPHBvc2l0aW9uLmxlbmd0aDtpKyspe1xuICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgcG9zaXRpb24ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgLy8gaWYoKHRoaXMuYm9hcmRbY29sdW1uW2ldKzFdW3RoaXMuYm9hcmRbY29sdW1uW2ldKzFdLmluZGV4T2YocG9zaXRpb25bal0rMTApXSkhPSd4Jyl7XG4gICAgICAgICAgdGhpcy5ib2FyZFtjb2x1bW5baV1dW3RoaXMuYm9hcmRbY29sdW1uW2ldXS5pbmRleE9mKHBvc2l0aW9uW2pdKV0gPSAneCc7XG4gICAgICAgIFxuICAgICAgICAvLyB9XG4gICAgfVxuICAgfVxuICAgXG4gIH1cbiAgY2hlY2tJZk91dE9mQm91bmQgPSAoZXZlbnQsaW5jcmVtZW50KT0+e1xuICAgIGxldCBzaGlwID0gdGhpcy5zaGlwO1xuICAgIGlmKGluY3JlbWVudCA9PT0xKXtcbiAgICAgICAgc3dpdGNoKHRydWUpeyBcbiAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09NSAmJiBvdXRPZkJvdW5kNS5pbmNsdWRlcyhldmVudC50YXJnZXQudmFsdWUlMTApOlxuICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09NCAmJiBvdXRPZkJvdW5kNC5pbmNsdWRlcyhldmVudC50YXJnZXQudmFsdWUlMTApOlxuICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09MyAmJiBvdXRPZkJvdW5kMy5pbmNsdWRlcyhldmVudC50YXJnZXQudmFsdWUlMTApOlxuICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09MiAmJiBvdXRPZkJvdW5kMi5pbmNsdWRlcyhldmVudC50YXJnZXQudmFsdWUlMTApOlxuICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IFxuICAgICB9XG4gICAgIGlmKGluY3JlbWVudCA9PT0xMCl7XG4gICAgICAgICBzd2l0Y2godHJ1ZSl7IFxuICAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09NSAmJiBvdXRPZkJvdW5kNS5pbmNsdWRlcyhNYXRoLmZsb29yKGV2ZW50LnRhcmdldC52YWx1ZS8xMCkpOlxuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09NCAmJiBvdXRPZkJvdW5kNC5pbmNsdWRlcyhNYXRoLmZsb29yKGV2ZW50LnRhcmdldC52YWx1ZS8xMCkpOlxuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09MyAmJiBvdXRPZkJvdW5kMy5pbmNsdWRlcyhNYXRoLmZsb29yKGV2ZW50LnRhcmdldC52YWx1ZS8xMCkpOlxuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09MiAmJiBvdXRPZkJvdW5kMi5pbmNsdWRlcyhNYXRoLmZsb29yKGV2ZW50LnRhcmdldC52YWx1ZS8xMCkpOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgfSBcbiAgICAgIH1cbn1cbiAgLy8gbmV4dFNoaXAoc2hpcCkge1xuICAvLyAgIGxldCBjb2x1bW4gPSBzaGlwLmNvbHVtbjtcbiAgLy8gICBsZXQgcG9zaXRpb24gPSBzaGlwLnBvc2l0aW9uO1xuICAvLyAgIGNvbnNvbGUubG9nKGNvbHVtblswXSk7XG4gIC8vICAgY29uc29sZS5sb2cocG9zaXRpb25bMF0rMTApO1xuICAvLyAgIGZvcihsZXQgaT0wOyBpPHBvc2l0aW9uLmxlbmd0aDtpKyspe1xuICAvLyAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgcG9zaXRpb24ubGVuZ3RoOyBqKyspIHtcbiAgLy8gICAgICAgbGV0IGluZGV4ID0gKHRoaXMuYm9hcmRbY29sdW1uWzBdKzFdW3RoaXMuYm9hcmRbY29sdW1uWzBdKzFdLmluZGV4T2YocG9zaXRpb25bMF0rMTApXSk7XG4gIC8vICAgICAgICAvL2NvbnNvbGUubG9nKCdpbmRleDonK2luZGV4KTtcbiAgLy8gICAgICAvLyAvLyBjb25zb2xlLmxvZyh0aGlzLmJvYXJkW2NvbHVtbltpXV1baW5kZXhbal1dKTtcbiAgLy8gICAgICAgICAvL3RoaXMuYm9hcmRbY29sdW1uW2ldXVt0aGlzLmJvYXJkW2NvbHVtbltpXV0uaW5kZXhPZihwb3NpdGlvbltqXSldID0gJ3gnO1xuICAgICAgXG4gICAgICAgIFxuICAgICAgXG4gIC8vICAgfVxuICAvLyAgIH1cbiAgIFxuICAgIFxuICAvLyB9XG4gIFxuXG4gIFxuXG4gIHJlY2lldmVBdHRhY2soY29sdW1uLCBwb3NpdGlvbikge1xuICAgIGlmICh0aGlzLmJvYXJkW2NvbHVtbl1bcG9zaXRpb25dID09PSBcInhcIikge1xuICAgICAgaWYgKHRoaXMuaGl0c1tjb2x1bW5dID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpcy5oaXRzW2NvbHVtbl0gPSBbcG9zaXRpb25dO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5oaXRzW2NvbHVtbl0ucHVzaChwb3NpdGlvbik7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0aGlzLm1pc3NlZFtjb2x1bW5dID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMubWlzc2VkW2NvbHVtbl0gPSBbcG9zaXRpb25dO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1pc3NlZFtjb2x1bW5dLnB1c2gocG9zaXRpb24pO1xuICAgIH1cbiAgfVxuIFxufVxuIiwiZXhwb3J0IGNsYXNzIFBsYXllcntcbiAgICBjb25zdHJ1Y3RvcigpeyBcbiAgICAgICAgdGhpcy50dXJuID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHRoaXMucG9zaXRpb247XG4gICAgfVxuICBcbiAgICBhdXRvUGxheSgpe1xuICAgICAgICBsZXQgcmFuZG9tID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjEwKTtcbiAgICAgICAgcmV0dXJuIHJhbmRvbTtcbiAgICB9XG59IiwiaW1wb3J0IEdhbWVCb2FyZCBmcm9tIFwiLi4vZmFjdG9yaWVzL0dhbWVCb2FyZFwiO1xuaW1wb3J0IHsgUGxheWVyIH0gZnJvbSBcIi4uL2ZhY3Rvcmllcy9QbGF5ZXJcIlxuaW1wb3J0IFNoaXAgZnJvbSBcIi4uL2ZhY3Rvcmllcy9TaGlwXCI7XG5pbXBvcnQgeyBjbGlja0V2ZW50LCBjcmVhdGVCb2FyZCwgcmVtb3ZlQm9hcmQsIHJlbmRlckFpU2hpcHMsIHJlbmRlclBsYXllclNoaXBzLCB1cGRhdGVCb2FyZCB9IGZyb20gXCIuL2RvbVwiO1xuXG5leHBvcnQgY29uc3QgcnVuR2FtZSA9ICgpPT57XG4gICAgY29uc3QgcGxheWVyID0gbmV3IFBsYXllcigpO1xuICAgIGNvbnN0IGFpID0gbmV3IFBsYXllcigpO1xuICAgIGNvbnN0IHBsYXllckJvYXJkID0gbmV3IEdhbWVCb2FyZCgpO1xuICAgIGNvbnN0IGFpQm9hcmQgPSBuZXcgR2FtZUJvYXJkKCk7XG4gICAgcGxheWVyQm9hcmQuaW5pdGlhbGl6ZSgwKTtcbiAgICBhaUJvYXJkLmluaXRpYWxpemUoMTAwKTtcbiAgICBjcmVhdGVCb2FyZChwbGF5ZXJCb2FyZCwnI3ByaW1hcnktY29udGFpbmVyJywncGxheWVyLWdyaWRzJywnaG9yaXpvbnRhbCcpO1xuICAgIGNyZWF0ZUJvYXJkKGFpQm9hcmQsJyNzZWNvbmRhcnktY29udGFpbmVyJywnYWktZ3JpZHMnLCd4Jyk7XG4gICAgIHJlbmRlclBsYXllclNoaXBzKHBsYXllckJvYXJkLDUpOyBcbiAgICByZW5kZXJBaVNoaXBzKGFpQm9hcmQpO1xuICAgIC8vIHJlbmRlclNoaXBzKGdhbWVib2FyZCw0KTtcbiAgIC8vIHVwZGF0ZUJvYXJkKGdhbWVib2FyZCwncHJpbWFyeS1jb250YWluZXInLFwicGxheWVyLWdyaWRzXCIpO1xuICAgICBcbiAgICAvLyBmb3IobGV0IGkgPTA7aTw0OyBpKyspe1xuICAgICAgIFxuICAgIC8vICAgICByZW5kZXJTaGlwcyhnYW1lYm9hcmQsNCk7XG4gICAgLy8gfVxuICAgICBcbiAgICBcblxuICAgXG4gICAgLy8gIGNvbnNvbGUubG9nKGdhbWVib2FyZC5ib2FyZCk7XG4gICAgLy8gIGNsaWNrRXZlbnQocGxheWVyLGFpKTtcbn1cbnJ1bkdhbWUoKTsiXSwibmFtZXMiOlsiU2hpcCIsImNvbnN0cnVjdG9yIiwibGVuZ3RoIiwiY29sdW1uIiwicG9zaXRpb24iLCJ0aGlzIiwiaGl0cyIsImhpdCIsImhpdFBvc2l0aW9uIiwiaW5jbHVkZXMiLCJwdXNoIiwiaXNTdW5rIiwiY3JlYXRlQm9hcmQiLCJuZXdCb2FyZCIsImlkIiwiY2xhc3NOYW1lIiwiZGlyZWN0aW9uIiwiY29udGFpbmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYm9hcmQiLCJjb25zb2xlIiwibG9nIiwiZm9yRWFjaCIsImUiLCJkaXYiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0QXR0cmlidXRlIiwiYXBwZW5kQ2hpbGQiLCJ2YWx1ZSIsInRleHRDb250ZW50IiwidXBkYXRlQm9hcmQiLCJjb250YWluZXJJRCIsImdyaWRJRCIsInJlbW92ZUJvYXJkIiwicXVlcnlTZWxlY3RvckFsbCIsImVsZW1lbnQiLCJyZW1vdmVDaGlsZCIsImNoZWNrSWZPdXRPZkJvdW5kIiwic2hpcCIsImV2ZW50IiwiaW5jcmVtZW50Iiwib3V0T2ZCb3VuZDUiLCJvdXRPZkJvdW5kNCIsIm91dE9mQm91bmQzIiwib3V0T2ZCb3VuZDIiLCJ0YXJnZXQiLCJNYXRoIiwiZmxvb3IiLCJnZXRDb29yZGluYXRlcyIsImNvbG9yIiwiY29vcmRpbmF0ZSIsImkiLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsImZsYWciLCJyb3RhdGVCdXR0b24iLCJyZW5kZXJQbGF5ZXJTaGlwcyIsImdhbWVib2FyZCIsImdyaWRzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNvbHVtbnMiLCJnZXRDb2x1bW5zIiwicGxhY2VTaGlwIiwiQXJyYXkiLCJmcm9tIiwiZmlsdGVyIiwiR2FtZUJvYXJkIiwibWlzc2VkIiwiaW5pdGlhbGl6ZSIsImNvdW50IiwiaiIsImluZGV4T2YiLCJyZWNpZXZlQXR0YWNrIiwidW5kZWZpbmVkIiwiUGxheWVyIiwidHVybiIsImF1dG9QbGF5IiwicmFuZG9tIiwicGxheWVyQm9hcmQiLCJhaUJvYXJkIiwic2hpcDIiLCJzaGlwMyIsInNoaXA0Iiwic2hpcDUiLCJyZW5kZXJBaVNoaXBzIiwicnVuR2FtZSJdLCJzb3VyY2VSb290IjoiIn0=