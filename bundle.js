(()=>{"use strict";class e{constructor(){this.turn=!0,this.position=this.position}autoPlay(e){return e[Math.floor(100*Math.random())]}}class t{constructor(e,t,r){this.length=e,this.hits=[],this.position=r||[],this.column=t||[]}hit(e){this.hits.push(e)}isSunk(){return this.length===this.hits.length}}const r=(e,t,r,l)=>{const a=document.querySelector(t);let n=e.board;console.log(n),n.forEach((e=>{e.forEach((e=>{const t=document.createElement("div");t.classList.add(r),t.classList.add(l),t.setAttribute("value",e),a.appendChild(t),t.value=e,t.textContent=e}))}))},l=(e,t,r,l)=>{a(t,r);const n=document.querySelector(`#${t}`);e.board.forEach((e=>{e.forEach((e=>{const t=document.createElement("div");t.classList.add(r),t.classList.add(l),t.setAttribute("value",e),n.appendChild(t),t.value=e,t.textContent=e}))}))},a=(e,t)=>{const r=document.querySelector(`#${e}`);document.querySelectorAll(`.${t}`).forEach((e=>{r.removeChild(e)}))},n=(e,t,r)=>{let l=[6,7,8,9],a=[7,8,9],n=[8,9],o=[9];if(1===r)switch(!0){case 5===e.length&&l.includes(t.target.value%10):case 4===e.length&&a.includes(t.target.value%10):case 3===e.length&&n.includes(t.target.value%10):case 2===e.length&&o.includes(t.target.value%10):return!0}if(10===r)switch(!0){case 5===e.length&&l.includes(Math.floor(t.target.value/10)):case 4===e.length&&a.includes(Math.floor(t.target.value/10)):case 3===e.length&&n.includes(Math.floor(t.target.value/10)):case 2===e.length&&o.includes(Math.floor(t.target.value/10)):return!0}},o=(e,t,r,l)=>{let a=[];if(1!==e.length){for(let o=0;o<=(e.length-1)*l;o+=l){if(n(e,t,l))return;if(5===e.length&&t.target.value%10==6)return;if(t.target.value+o=="x0")return;if(null===document.querySelector(`div[value="${t.target.value+o}"]`))return;if(t.target.value+o=="x0")return;document.querySelector(`div[value="${t.target.value+o}"]`).style.backgroundColor=r,a.push(t.target.value+o)}return a}};let i=!0,c="horizontal",s=1;const u=document.querySelector("#rotate"),d=(e,r)=>{let a=document.querySelectorAll(`.player-grids.${c}`);const n=new t(r,[0,0,0],[1,2,3]);3===r&&i&&(r+=1,i=!1),r<=0||(a.forEach((t=>t.addEventListener("mouseover",(a=>{o(n,a,"blue",s),t.addEventListener("click",(t=>{n.position=o(n,t,"gray",s),n.column=(e=>{let t=[];for(let r=0;r<=e.length-1;r++)e.position[r]&&t.push(Math.floor(e.position[r]/10));return t})(n),e.placeShip(n),l(e,"primary-container","player-grids",c),Array.from(document.querySelectorAll(".player-grids")).filter((e=>"x"===e.value)).forEach((e=>e.style.backgroundColor="transparent")),d(e,r-1)}))})))),a.forEach((e=>e.addEventListener("mouseout",(e=>{o(n,e,"gray",s)})))))};u.addEventListener("click",(e=>{"horizontal"===c?(c="vertical",s=10):"vertical"===c&&(c="horizontal",s=1)}));class h{constructor(e){this.board=e||[],this.missed=[[]],this.hits=[]}initialize(e){for(let t=0;t<10;t++){this.board[t]=[];for(let r=0;r<10;r++)this.board[t][r]=e,e++}}placeShip(e){let t=e.column,r=e.position;for(let e=0;e<r.length;e++)for(let l=0;l<r.length;l++)this.board[t[e]][this.board[t[e]].indexOf(r[l])]="x"}recieveAttack(e){this.hits.push(e)}}(()=>{new e,new e;const a=new h,n=new h;a.initialize(0),n.initialize(100),r(a,"#primary-container","player-grids","horizontal"),r(n,"#secondary-container","ai-grids","x"),d(a,5),(e=>{const r=new t(5,[0,0,0,0,0],[101,102,103,104,105]),a=new t(4,[7,7,7,7],[173,174,175,176]),n=new t(3,[2,2,2],[122,123,124]),o=new t(3,[4,4,4],[144,145,146]),i=new t(2,[8,9],[181,191]);e.placeShip(r),e.placeShip(a),e.placeShip(n),e.placeShip(o),e.placeShip(i),l(e,"secondary-container","ai-grids")})(n),((t,r)=>{let l,a,n;const o=document.querySelectorAll(".player-grids");document.querySelectorAll(".ai-grids").forEach((i=>i.addEventListener("click",(c=>{const s=c.target.value;l=new e,a=l.autoPlay(o),n=a.value,"x"===s?(t.recieveAttack(s),i.style.backgroundColor="red",((e,t,r)=>{e.addEventListener("click",(l=>{const a=l.target.value;"x"===t?(r.recieveAttack(t),e.style.backgroundColor="red",r.recieveAttack(a)):e.style.backgroundColor="green"}));const l=new Event("click");e.dispatchEvent(l)})(a,n,r)):i.style.backgroundColor="green"}))))})(n,a)})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZmFjdG9yaWVzL1BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2ZhY3Rvcmllcy9TaGlwLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvc2NyaXB0cy9kb20uanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9mYWN0b3JpZXMvR2FtZUJvYXJkLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvc2NyaXB0cy9tYWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBQbGF5ZXJ7XG4gICAgY29uc3RydWN0b3IoKXsgXG4gICAgICAgIHRoaXMudHVybiA9IHRydWU7XG4gICAgICAgIHRoaXMucG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uO1xuICAgIH1cbiAgXG4gICAgYXV0b1BsYXkoZ3JpZCl7XG4gICAgICAgIFxuICAgICAgICBsZXQgcmFuZG9tID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjEwMCk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZ3JpZFtyYW5kb21dO1xuICAgIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTaGlwe1xuICAgIGNvbnN0cnVjdG9yKGxlbmd0aCxjb2x1bW4scG9zaXRpb24pe1xuICAgICAgICB0aGlzLmxlbmd0aCA9IGxlbmd0aDtcbiAgICAgICAgdGhpcy5oaXRzID0gW107XG4gICAgICAgIHRoaXMucG9zaXRpb24gPSBwb3NpdGlvbnx8W107XG4gICAgICAgIHRoaXMuY29sdW1uID0gY29sdW1ufHxbXTtcbiAgICAgICBcbiAgICB9XG4gICAgaGl0KGhpdFBvc2l0aW9uKXtcbiAgICAgICAgLy8gaWYodGhpcy5wb3NpdGlvbi5pbmNsdWRlcyhoaXRQb3NpdGlvbikmJiAhKHRoaXMuaGl0cy5pbmNsdWRlcyhoaXRQb3NpdGlvbikpKXtcbiAgICAgICAgICAgIHRoaXMuaGl0cy5wdXNoKGhpdFBvc2l0aW9uKTtcbiAgICAgICAgLy99XG4gICAgICAgIFxuICAgIH1cblxuICAgIGlzU3Vuaygpe1xuICAgICAgICBpZih0aGlzLmxlbmd0aCA9PT0gdGhpcy5oaXRzLmxlbmd0aCl7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG4iLCJpbXBvcnQgR2FtZUJvYXJkIGZyb20gXCIuLi9mYWN0b3JpZXMvR2FtZUJvYXJkXCI7XG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi4vZmFjdG9yaWVzL1BsYXllclwiO1xuaW1wb3J0IFNoaXAgZnJvbSBcIi4uL2ZhY3Rvcmllcy9TaGlwXCI7XG5cblxuLy8gVE9ETzogRml4IHNoaXAgaXNzdWUgd2hlcmUgc2hpcCBwbGFjZW1lbnQgb3ZlcmxhcFxuXG5leHBvcnQgY29uc3QgY3JlYXRlQm9hcmQgPSAobmV3Qm9hcmQsaWQsY2xhc3NOYW1lLGRpcmVjdGlvbik9PntcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGlkKTtcbiAgICBcbiAgICBsZXQgYm9hcmQgPSBuZXdCb2FyZC5ib2FyZDtcbiAgICBjb25zb2xlLmxvZyhib2FyZCk7XG4gICAgYm9hcmQuZm9yRWFjaChlPT57XG4gICAgICAgIGUuZm9yRWFjaChlPT57XG4gICAgICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7IFxuICAgICAgICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoZGlyZWN0aW9uKTsgXG4gICAgICAgICAgICBkaXYuc2V0QXR0cmlidXRlKCd2YWx1ZScsZSk7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoZGl2KTtcbiAgICAgICAgICAgIGRpdi52YWx1ZSA9IGU7XG4gICAgICAgICAgICBkaXYudGV4dENvbnRlbnQgPSBlO1xuICAgICAgICAgICAgXG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuZXhwb3J0IGNvbnN0IHVwZGF0ZUJvYXJkID0gKG5ld0JvYXJkLGNvbnRhaW5lcklELGdyaWRJRCxkaXJlY3Rpb24pPT57XG4gICAgcmVtb3ZlQm9hcmQoY29udGFpbmVySUQsZ3JpZElEKTtcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtjb250YWluZXJJRH1gKTtcbiAgICBsZXQgYm9hcmQgPSBuZXdCb2FyZC5ib2FyZDtcbiAgICBib2FyZC5mb3JFYWNoKGU9PntcbiAgICAgICAgZS5mb3JFYWNoKGU9PntcbiAgICAgICAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoZ3JpZElEKTsgXG4gICAgICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKGRpcmVjdGlvbik7IFxuICAgICAgICAgICAgZGl2LnNldEF0dHJpYnV0ZSgndmFsdWUnLGUpO1xuICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGRpdik7XG4gICAgICAgICAgICBkaXYudmFsdWUgPSBlO1xuICAgICAgICAgICAgZGl2LnRleHRDb250ZW50ID0gZTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgXG4gICAgICAgIH0pO1xuICAgICAgICAgXG4gICAgfSk7XG5cbiAgICBcbn1cbmV4cG9ydCBjb25zdCByZW1vdmVCb2FyZCA9IChjb250YWluZXJJRCxncmlkSUQpPT57XG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7Y29udGFpbmVySUR9YCk7XG4gICAgY29uc3QgZ3JpZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC4ke2dyaWRJRH1gKTtcbiAgICBncmlkLmZvckVhY2goZWxlbWVudD0+IHsgXG4gICAgICAgICAgICBcbiAgICAgICAgIGNvbnRhaW5lci5yZW1vdmVDaGlsZChlbGVtZW50KVxuICAgICAgXG4gICAgICAgXG4gICAgfSk7XG59XG5leHBvcnQgY29uc3QgY2xpY2tFdmVudCA9IChwbGF5ZXIsYWkpPT57XG4gICAgY29uc3QgZ3JpZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ3JpZHMnKTtcbiAgICBncmlkcy5mb3JFYWNoKGVsZW1lbnQ9PmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLChlKT0+e1xuICAgICAgICBpZihwbGF5ZXIudHVybil7XG4gICAgICAgICAgICAgYWkudHVybiA9IHRydWU7XG4gICAgICAgICAgICAgcGxheWVyLnR1cm4gPSBmYWxzZTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3BsYXllcjogJytlLnRhcmdldC52YWx1ZSk7XG4gICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgRXZlbnQoJ2NsaWNrJyk7XG4gICAgICAgICAgICBlbGVtZW50LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgICAgICB9ZWxzZSBpZihhaS50dXJuKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhaTogJysgYWkuYXV0b1BsYXkoKSk7XG4gICAgICAgICAgICBhaS50dXJuID0gZmFsc2U7XG4gICAgICAgICAgICBwbGF5ZXIudHVybiA9IHRydWU7XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9KSk7XG59XG5cbmNvbnN0IGNoZWNrSWZPdXRPZkJvdW5kID0gKHNoaXAsZXZlbnQsaW5jcmVtZW50KT0+e1xuICAgIGxldCBvdXRPZkJvdW5kNSA9IFs2LDcsOCw5XTtcbiAgICAgbGV0IG91dE9mQm91bmQ0ID0gWzcsOCw5XTtcbiAgICAgbGV0IG91dE9mQm91bmQzID0gWzgsOV07XG4gICAgIGxldCBvdXRPZkJvdW5kMiA9IFs5XTtcbiAgICBcbiAgICBpZihpbmNyZW1lbnQgPT09MSl7XG4gICAgICAgIHN3aXRjaCh0cnVlKXsgXG4gICAgICAgICAgICAgY2FzZSBzaGlwLmxlbmd0aD09PTUgJiYgb3V0T2ZCb3VuZDUuaW5jbHVkZXMoZXZlbnQudGFyZ2V0LnZhbHVlJTEwKTpcbiAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgY2FzZSBzaGlwLmxlbmd0aD09PTQgJiYgb3V0T2ZCb3VuZDQuaW5jbHVkZXMoZXZlbnQudGFyZ2V0LnZhbHVlJTEwKTpcbiAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgY2FzZSBzaGlwLmxlbmd0aD09PTMgJiYgb3V0T2ZCb3VuZDMuaW5jbHVkZXMoZXZlbnQudGFyZ2V0LnZhbHVlJTEwKTpcbiAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgY2FzZSBzaGlwLmxlbmd0aD09PTIgJiYgb3V0T2ZCb3VuZDIuaW5jbHVkZXMoZXZlbnQudGFyZ2V0LnZhbHVlJTEwKTpcbiAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IFxuICAgICB9XG4gICAgIGlmKGluY3JlbWVudCA9PT0xMCl7XG4gICAgICAgICBzd2l0Y2godHJ1ZSl7IFxuICAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09NSAmJiBvdXRPZkJvdW5kNS5pbmNsdWRlcyhNYXRoLmZsb29yKGV2ZW50LnRhcmdldC52YWx1ZS8xMCkpOlxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgIGNhc2Ugc2hpcC5sZW5ndGg9PT00ICYmIG91dE9mQm91bmQ0LmluY2x1ZGVzKE1hdGguZmxvb3IoZXZlbnQudGFyZ2V0LnZhbHVlLzEwKSk6XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgY2FzZSBzaGlwLmxlbmd0aD09PTMgJiYgb3V0T2ZCb3VuZDMuaW5jbHVkZXMoTWF0aC5mbG9vcihldmVudC50YXJnZXQudmFsdWUvMTApKTpcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09MiAmJiBvdXRPZkJvdW5kMi5pbmNsdWRlcyhNYXRoLmZsb29yKGV2ZW50LnRhcmdldC52YWx1ZS8xMCkpOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICB9IFxuICAgICAgfVxufVxuY29uc3QgZ2V0Q29vcmRpbmF0ZXMgPSAoc2hpcCxldmVudCxjb2xvcixpbmNyZW1lbnQpPT57XG4gIFxuXG4gIGxldCBjb29yZGluYXRlID0gW107XG4gIGlmIChzaGlwLmxlbmd0aCA9PT0gMSkge1xuICAgIHJldHVybjtcbiAgfVxuICBmb3IgKGxldCBpID0gMDsgaSA8PSAoc2hpcC5sZW5ndGggLSAxKSAqIGluY3JlbWVudDsgaSA9IGkgKyBpbmNyZW1lbnQpIHtcbiAgICAgaWYoY2hlY2tJZk91dE9mQm91bmQoc2hpcCxldmVudCxpbmNyZW1lbnQpKSByZXR1cm47XG4gICBcbiAgICBpZiAoc2hpcC5sZW5ndGggPT09IDUpIHtcbiAgICAgIGlmIChldmVudC50YXJnZXQudmFsdWUgJSAxMCA9PT0gNikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChldmVudC50YXJnZXQudmFsdWUgKyBpID09IFwieDBcIikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBkaXZbdmFsdWU9XCIke2V2ZW50LnRhcmdldC52YWx1ZSArIGl9XCJdYCkgPT09IG51bGxcbiAgICApIHtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC52YWx1ZSArIGkgPT0gXCJ4MFwiKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGBkaXZbdmFsdWU9XCIke2V2ZW50LnRhcmdldC52YWx1ZSArIGl9XCJdYFxuICAgICkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3I7XG4gICAgY29vcmRpbmF0ZS5wdXNoKGV2ZW50LnRhcmdldC52YWx1ZSArIGkpO1xuICB9XG4gIHJldHVybiBjb29yZGluYXRlO1xufVxuY29uc3QgZ2V0Q29sdW1ucyA9IChzaGlwKT0+e1xuICAgIGxldCBjb2x1bW5zID0gW107XG4gICAgZm9yKGxldCBpID0gMDsgaTw9c2hpcC5sZW5ndGgtMTsgaSsrKXtcbiAgICAgICAgXG4gICAgICAgICAgaWYoc2hpcC5wb3NpdGlvbltpXSl7XG4gICAgICAgICAgICAgY29sdW1ucy5wdXNoKE1hdGguZmxvb3IoKHNoaXAucG9zaXRpb25baV0pLzEwKSk7XG4gICAgICAgIH0gIFxuICAgICAgICBcbiAgICAgICAgXG5cbiAgICAgICBcbiAgICB9XG4gIFxuICAgIHJldHVybiBjb2x1bW5zO1xufVxuY29uc3QgY2hhbmdlQ29sb3IgPSAoKSA9PntcbiAgICBjb25zdCBzZWxlY3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wbGF5ZXItZ3JpZHMnKSk7XG4gICAgc2VsZWN0LmZpbHRlcihlbGVtZW50PT5lbGVtZW50LnZhbHVlPT09J3gnKS5mb3JFYWNoKGVsZW1lbnQ9PmVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3RyYW5zcGFyZW50Jyk7XG4gICAgXG4gICAgXG59XG5sZXQgZmxhZyA9IHRydWU7XG4gbGV0IGRpcmVjdGlvbiA9ICdob3Jpem9udGFsJztcbiBsZXQgaW5jcmVtZW50ID0gMTtcbiBjb25zdCByb3RhdGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcm90YXRlJyk7XG5cbmV4cG9ydCBjb25zdCByZW5kZXJQbGF5ZXJTaGlwcyA9ICAoZ2FtZWJvYXJkLGxlbmd0aCkgPT57XG4gICAgXG4gICBcbiAgICBsZXQgZ3JpZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAucGxheWVyLWdyaWRzLiR7ZGlyZWN0aW9ufWApO1xuICAgIFxuICAgIFxuICAgIGNvbnN0IHNoaXAgPSBuZXcgU2hpcChsZW5ndGgsWzAsMCwwXSxbMSwyLDNdKTtcbiAgICBcbiAgICBpZihsZW5ndGg9PT0zKXtcbiAgICAgICAgaWYoZmxhZyl7XG4gICAgICAgICAgIGxlbmd0aCs9MTsgXG4gICAgICAgICAgIGZsYWc9ZmFsc2U7XG4gICAgICAgIH0gXG4gICAgfVxuICAgIGlmKGxlbmd0aDw9MCl7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gY29uc3QgY2hlY2tOZWFyU2hpcHMgPShib2FyZCxzaGlwKT0+e1xuICAgIC8vICAgICBsZXQgcG9zaXRpb24gPSBzaGlwLnBvc2l0aW9uO1xuICAgIC8vICAgICBsZXQgY29sdW1uID0gc2hpcC5jb2x1bW47XG4gICAgLy8gICAgIGZvcihsZXQgaSA9MDsgaTxzaGlwLmxlbmd0aDtpKyspe1xuICAgIC8vICAgICAgICAgZm9yKGxldCBqID0gMDsgajxzaGlwLmxlbmd0aDtqKyspe1xuICAgIC8vICAgICAgICAgICAgIGlmKChib2FyZC5ib2FyZFtjb2x1bW5baV1dW3Bvc2l0aW9uW2pdXSkuZXF1YWxzKCd4Jykpe1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAvLyAgICAgICAgfSBcbiAgICAgICAgICAgXG4gICAgLy8gICAgIH1cbiAgICAvLyAgICAgfVxuICAgIC8vIH1cbiAgICBncmlkcy5mb3JFYWNoKGVsZW1lbnQ9PmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywoZSk9PntcbiAgICAgICAgICAgICBnZXRDb29yZGluYXRlcyhzaGlwLGUsJ2JsdWUnLGluY3JlbWVudCk7XG4gICAgICAgICAgICAgXG4gICAgICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLChlKT0+e1xuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgIHNoaXAucG9zaXRpb24gPSBnZXRDb29yZGluYXRlcyhzaGlwLGUsJ2dyYXknLGluY3JlbWVudCk7XG4gICAgICAgICAgICAgICBzaGlwLmNvbHVtbiA9IGdldENvbHVtbnMoc2hpcCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgIGdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcCk7XG4gICAgICAgICAgICAgICAgIHVwZGF0ZUJvYXJkKGdhbWVib2FyZCwncHJpbWFyeS1jb250YWluZXInLFwicGxheWVyLWdyaWRzXCIsZGlyZWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIGNoYW5nZUNvbG9yKCk7XG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmVuZGVyUGxheWVyU2hpcHMoZ2FtZWJvYXJkLGxlbmd0aC0xKTtcbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgXG4gICAgfSkpO1xuICAgIFxuXG4gICAgZ3JpZHMuZm9yRWFjaChlbGVtZW50PT5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywoZSk9PntcbiAgICAgICAgZ2V0Q29vcmRpbmF0ZXMoc2hpcCxlLCdncmF5JyxpbmNyZW1lbnQpO1xuICAgIH0pKTsgIFxuICAgIFxuICAgXG4gICBcbn1cblxubGV0IHR1cm4gPSB0cnVlO1xuZXhwb3J0IGNvbnN0IHJlbmRlckF0dGFjayA9IChhaUJvYXJkLHBsYXllckJvYXJkKSA9PntcbiAgICBsZXQgYWk7XG4gICAgbGV0IHJhbmRvbWx5UGlja2VkR3JpZDtcbiAgICBsZXQgZ3JpZFZhbHVlO1xuICAgIGNvbnN0IHBsYXllckdyaWRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBsYXllci1ncmlkcycpO1xuICAgIGNvbnN0IGFpR3JpZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYWktZ3JpZHMnKTtcbiAgICBcbiAgICBcbiAgICAgICAgXG4gICAgICAgIGFpR3JpZHMuZm9yRWFjaChlbGVtZW50PT5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSk9PntcbiAgICAgICAgICAgICAgY29uc3QgZWxlbWVudFZhbHVlID0gZS50YXJnZXQudmFsdWU7XG4gICAgICAgICAgICAgIGFpID0gbmV3IFBsYXllcigpO1xuICAgICAgICAgICAgICByYW5kb21seVBpY2tlZEdyaWQgPSBhaS5hdXRvUGxheShwbGF5ZXJHcmlkcyk7XG4gICAgICAgICAgICAgIGdyaWRWYWx1ZSA9IHJhbmRvbWx5UGlja2VkR3JpZC52YWx1ZTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYoZWxlbWVudFZhbHVlID09PSAneCcpe1xuICAgICAgICAgICAgICAgIGFpQm9hcmQucmVjaWV2ZUF0dGFjayhlbGVtZW50VmFsdWUpO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3JlZCc7XG4gICAgICAgICAgICAgICAgcmVuZGVyQWlBdHRhY2socmFuZG9tbHlQaWNrZWRHcmlkLGdyaWRWYWx1ZSxwbGF5ZXJCb2FyZCk7XG4gICAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnZ3JlZW4nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIH0pKTtcbiAgICAgICAgXG5cbiAgICBcbiAgICB9XG5jb25zdCByZW5kZXJBaUF0dGFjayA9IChyYW5kb21seVBpY2tlZEdyaWQsZ3JpZFZhbHVlLHBsYXllckJvYXJkKT0+e1xuICAgIHJhbmRvbWx5UGlja2VkR3JpZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKGUpPT57XG4gICAgICAgIGNvbnN0IGVsZW1lbnRWYWx1ZSA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgICBpZihncmlkVmFsdWU9PT0gJ3gnKXtcbiAgICAgICAgICAgIHBsYXllckJvYXJkLnJlY2lldmVBdHRhY2soZ3JpZFZhbHVlKTtcbiAgICAgICAgICAgIHJhbmRvbWx5UGlja2VkR3JpZC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmVkJztcbiAgICAgICAgICAgIHBsYXllckJvYXJkLnJlY2lldmVBdHRhY2soZWxlbWVudFZhbHVlKVxuXG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgcmFuZG9tbHlQaWNrZWRHcmlkLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdncmVlbic7XG4gICAgICAgIH1cbiAgICAgfSk7XG4gICAgICBjb25zdCBldmVudCA9IG5ldyBFdmVudCgnY2xpY2snKTtcbiAgICAgcmFuZG9tbHlQaWNrZWRHcmlkLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xufVxuXG5leHBvcnQgY29uc3QgcmVuZGVyUGxheWVyQXR0YWNrID0gKGJvYXJkKT0+e1xuICAgIGNvbnN0IGFpR3JpZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYWktZ3JpZHMnKTtcbiAgICBhaUdyaWRzLmZvckVhY2goZWxlbWVudD0+ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKGUpPT57XG4gICAgICAgIGlmKGUudGFyZ2V0LnZhbHVlID09PSAneCcpe1xuICAgICAgICAgICAgYm9hcmQucmVjaWV2ZUF0dGFjayhlLnRhcmdldC52YWx1ZSk7XG4gICAgICAgICAgICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZWQnO1xuICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdncmVlbic7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfSkpO1xufVxuXG4gcm90YXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSk9PntcbiAgICAgIFxuICAgICAgICBpZihkaXJlY3Rpb24gPT09J2hvcml6b250YWwnKXtcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9ICd2ZXJ0aWNhbCc7XG4gICAgICAgICAgICBpbmNyZW1lbnQgPSAxMDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgXG4gICAgICAgIH1lbHNlIGlmKGRpcmVjdGlvbiA9PT0ndmVydGljYWwnKXtcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9ICdob3Jpem9udGFsJztcbiAgICAgICAgICAgIGluY3JlbWVudCA9IDE7XG4gICAgICAgICAgIFxuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIFxuICAgIH0pO1xuXG5cblxuXG5cbmV4cG9ydCBjb25zdCByZW5kZXJBaVNoaXBzID0gIChnYW1lYm9hcmQpID0+e1xuICAgIGNvbnN0IHNoaXAgPSBuZXcgU2hpcCg1LFswLDAsMCwwLDBdLFsxMDEsMTAyLDEwMywxMDQsMTA1XSk7XG4gICAgY29uc3Qgc2hpcDIgPSBuZXcgU2hpcCg0LFs3LDcsNyw3XSxbMTczLDE3NCwxNzUsMTc2XSk7XG4gICAgY29uc3Qgc2hpcDMgPSBuZXcgU2hpcCgzLFsyLDIsMl0sWzEyMiwxMjMsMTI0XSk7XG4gICAgY29uc3Qgc2hpcDQgPSBuZXcgU2hpcCgzLFs0LDQsNF0sWzE0NCwxNDUsMTQ2XSk7XG4gICAgY29uc3Qgc2hpcDUgPSBuZXcgU2hpcCgyLFs4LDldLFsxODEsMTkxXSk7XG4gICAgXG4gICAgZ2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwKTtcbiAgICBnYW1lYm9hcmQucGxhY2VTaGlwKHNoaXAyKTtcbiAgICBnYW1lYm9hcmQucGxhY2VTaGlwKHNoaXAzKTtcbiAgICBnYW1lYm9hcmQucGxhY2VTaGlwKHNoaXA0KTtcbiAgICBnYW1lYm9hcmQucGxhY2VTaGlwKHNoaXA1KTtcbiAgICB1cGRhdGVCb2FyZChnYW1lYm9hcmQsJ3NlY29uZGFyeS1jb250YWluZXInLFwiYWktZ3JpZHNcIik7XG59XG5cblxuXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lQm9hcmQge1xuICBjb25zdHJ1Y3Rvcihib2FyZCkge1xuICAgIHRoaXMuYm9hcmQgPSBib2FyZCB8fCBbXTtcbiAgICB0aGlzLm1pc3NlZCA9IFtbXV07XG4gICAgdGhpcy5oaXRzID0gW107XG4gICAgXG4gIH1cblxuICBpbml0aWFsaXplKGNvdW50KSB7XG4gICAgXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICB0aGlzLmJvYXJkW2ldID0gW107XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDEwOyBqKyspIHtcbiAgICAgICAgdGhpcy5ib2FyZFtpXVtqXSA9IGNvdW50O1xuICAgICAgICBjb3VudCsrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBcblxuXG4gIHBsYWNlU2hpcChzaGlwKSB7XG4gICAgbGV0IGNvbHVtbiA9IHNoaXAuY29sdW1uO1xuICAgIGxldCBwb3NpdGlvbiA9IHNoaXAucG9zaXRpb247XG4gICAgXG4gICBcbiAgICBmb3IobGV0IGk9MDsgaTxwb3NpdGlvbi5sZW5ndGg7aSsrKXtcbiAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHBvc2l0aW9uLmxlbmd0aDsgaisrKSB7XG4gICAgICAgIC8vIGlmKCh0aGlzLmJvYXJkW2NvbHVtbltpXSsxXVt0aGlzLmJvYXJkW2NvbHVtbltpXSsxXS5pbmRleE9mKHBvc2l0aW9uW2pdKzEwKV0pIT0neCcpe1xuICAgICAgICAgIHRoaXMuYm9hcmRbY29sdW1uW2ldXVt0aGlzLmJvYXJkW2NvbHVtbltpXV0uaW5kZXhPZihwb3NpdGlvbltqXSldID0gJ3gnO1xuICAgICAgICBcbiAgICAgICAgLy8gfVxuICAgIH1cbiAgIH1cbiAgIFxuICB9XG4gIFxuIFxuIFxuICByZWNpZXZlQXR0YWNrKHBvc2l0aW9uKXtcbiAgICBcbiAgICAgICAgdGhpcy5oaXRzLnB1c2gocG9zaXRpb24pO1xuICAgIFxuICB9XG5cbiAgXG5cbiAgLy8gcmVjaWV2ZUF0dGFjayhjb2x1bW4sIHBvc2l0aW9uKSB7XG4gIC8vICAgZm9yKGxldCBpPTA7IGk8cG9zaXRpb24ubGVuZ3RoOyBpKyspe1xuICAvLyAgICAgZm9yKGxldCBqPTA7IGo8cG9zaXRpb24ubGVuZ3RoOyBqKyspe1xuICAvLyAgICAgICBpZiAodGhpcy5ib2FyZFtjb2x1bW5baV1dW3Bvc2l0aW9uW2pdXSA9PT0gXCJ4XCIpIHtcbiAgLy8gICAgICAgICBpZiAodGhpcy5oaXRzW2NvbHVtbltpXV0gPT09IHVuZGVmaW5lZCkge1xuICAvLyAgICAgICB0aGlzLmhpdHNbY29sdW1uW2ldXSA9IFtwb3NpdGlvbltqXV07XG4gIC8vICAgICB9IGVsc2Uge1xuICAvLyAgICAgICB0aGlzLmhpdHNbY29sdW1uW2ldXS5wdXNoKHBvc2l0aW9uW2ldKTtcbiAgLy8gICAgIH1cbiAgLy8gICB9IGVsc2UgaWYgKHRoaXMubWlzc2VkW2NvbHVtbl0gPT09IHVuZGVmaW5lZCkge1xuICAvLyAgICAgdGhpcy5taXNzZWRbY29sdW1uXSA9IFtwb3NpdGlvbl07XG4gIC8vICAgfSBlbHNlIHtcbiAgLy8gICAgIHRoaXMubWlzc2VkW2NvbHVtbl0ucHVzaChwb3NpdGlvbik7XG4gIC8vICAgfVxuICAvLyAgICAgfVxuICAvLyAgIH1cbiAgICBcbiAgLy8gfVxuIFxufVxuIiwiaW1wb3J0IEdhbWVCb2FyZCBmcm9tIFwiLi4vZmFjdG9yaWVzL0dhbWVCb2FyZFwiO1xuaW1wb3J0IHsgUGxheWVyIH0gZnJvbSBcIi4uL2ZhY3Rvcmllcy9QbGF5ZXJcIlxuaW1wb3J0IFNoaXAgZnJvbSBcIi4uL2ZhY3Rvcmllcy9TaGlwXCI7XG5pbXBvcnQgeyBjbGlja0V2ZW50LCBjcmVhdGVCb2FyZCwgcmVtb3ZlQm9hcmQsIHJlbmRlckFpU2hpcHMsIHJlbmRlckF0dGFjaywgcmVuZGVyUGxheWVyU2hpcHMsIHVwZGF0ZUJvYXJkICwgcmVuZGVyQWlBdHRhY2t9IGZyb20gXCIuL2RvbVwiO1xuXG5leHBvcnQgY29uc3QgcnVuR2FtZSA9ICgpPT57XG4gICAgY29uc3QgcGxheWVyID0gbmV3IFBsYXllcigpO1xuICAgIGNvbnN0IGFpID0gbmV3IFBsYXllcigpO1xuICAgXG5cbiAgICBjb25zdCBwbGF5ZXJCb2FyZCA9IG5ldyBHYW1lQm9hcmQoKTtcbiAgICBjb25zdCBhaUJvYXJkID0gbmV3IEdhbWVCb2FyZCgpO1xuICAgIHBsYXllckJvYXJkLmluaXRpYWxpemUoMCk7XG4gICAgYWlCb2FyZC5pbml0aWFsaXplKDEwMCk7XG4gICAgY3JlYXRlQm9hcmQocGxheWVyQm9hcmQsJyNwcmltYXJ5LWNvbnRhaW5lcicsJ3BsYXllci1ncmlkcycsJ2hvcml6b250YWwnKTtcbiAgICBjcmVhdGVCb2FyZChhaUJvYXJkLCcjc2Vjb25kYXJ5LWNvbnRhaW5lcicsJ2FpLWdyaWRzJywneCcpO1xuICAgICByZW5kZXJQbGF5ZXJTaGlwcyhwbGF5ZXJCb2FyZCw1KTsgXG4gICAgcmVuZGVyQWlTaGlwcyhhaUJvYXJkKTtcbiAgIFxuICAgIHJlbmRlckF0dGFjayhhaUJvYXJkLHBsYXllckJvYXJkKTtcbiAgICBcbiAgICAvLyByZW5kZXJTaGlwcyhnYW1lYm9hcmQsNCk7XG4gICAvLyB1cGRhdGVCb2FyZChnYW1lYm9hcmQsJ3ByaW1hcnktY29udGFpbmVyJyxcInBsYXllci1ncmlkc1wiKTtcbiAgICAgXG4gICAgLy8gZm9yKGxldCBpID0wO2k8NDsgaSsrKXtcbiAgICAgICBcbiAgICAvLyAgICAgcmVuZGVyU2hpcHMoZ2FtZWJvYXJkLDQpO1xuICAgIC8vIH1cbiAgICAgXG4gICAgXG5cbiAgIFxuICAgIC8vICBjb25zb2xlLmxvZyhnYW1lYm9hcmQuYm9hcmQpO1xuICAgIC8vICBjbGlja0V2ZW50KHBsYXllcixhaSk7XG59XG5ydW5HYW1lKCk7Il0sIm5hbWVzIjpbIlBsYXllciIsImNvbnN0cnVjdG9yIiwidGhpcyIsInR1cm4iLCJwb3NpdGlvbiIsImF1dG9QbGF5IiwiZ3JpZCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsIlNoaXAiLCJsZW5ndGgiLCJjb2x1bW4iLCJoaXRzIiwiaGl0IiwiaGl0UG9zaXRpb24iLCJwdXNoIiwiaXNTdW5rIiwiY3JlYXRlQm9hcmQiLCJuZXdCb2FyZCIsImlkIiwiY2xhc3NOYW1lIiwiZGlyZWN0aW9uIiwiY29udGFpbmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYm9hcmQiLCJjb25zb2xlIiwibG9nIiwiZm9yRWFjaCIsImUiLCJkaXYiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0QXR0cmlidXRlIiwiYXBwZW5kQ2hpbGQiLCJ2YWx1ZSIsInRleHRDb250ZW50IiwidXBkYXRlQm9hcmQiLCJjb250YWluZXJJRCIsImdyaWRJRCIsInJlbW92ZUJvYXJkIiwicXVlcnlTZWxlY3RvckFsbCIsImVsZW1lbnQiLCJyZW1vdmVDaGlsZCIsImNoZWNrSWZPdXRPZkJvdW5kIiwic2hpcCIsImV2ZW50IiwiaW5jcmVtZW50Iiwib3V0T2ZCb3VuZDUiLCJvdXRPZkJvdW5kNCIsIm91dE9mQm91bmQzIiwib3V0T2ZCb3VuZDIiLCJpbmNsdWRlcyIsInRhcmdldCIsImdldENvb3JkaW5hdGVzIiwiY29sb3IiLCJjb29yZGluYXRlIiwiaSIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwiZmxhZyIsInJvdGF0ZUJ1dHRvbiIsInJlbmRlclBsYXllclNoaXBzIiwiZ2FtZWJvYXJkIiwiZ3JpZHMiLCJhZGRFdmVudExpc3RlbmVyIiwiY29sdW1ucyIsImdldENvbHVtbnMiLCJwbGFjZVNoaXAiLCJBcnJheSIsImZyb20iLCJmaWx0ZXIiLCJHYW1lQm9hcmQiLCJtaXNzZWQiLCJpbml0aWFsaXplIiwiY291bnQiLCJqIiwiaW5kZXhPZiIsInJlY2lldmVBdHRhY2siLCJwbGF5ZXJCb2FyZCIsImFpQm9hcmQiLCJzaGlwMiIsInNoaXAzIiwic2hpcDQiLCJzaGlwNSIsInJlbmRlckFpU2hpcHMiLCJhaSIsInJhbmRvbWx5UGlja2VkR3JpZCIsImdyaWRWYWx1ZSIsInBsYXllckdyaWRzIiwiZWxlbWVudFZhbHVlIiwiRXZlbnQiLCJkaXNwYXRjaEV2ZW50IiwicmVuZGVyQWlBdHRhY2siLCJyZW5kZXJBdHRhY2siLCJydW5HYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==