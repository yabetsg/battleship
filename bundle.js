(()=>{"use strict";class e{constructor(e){this.board=e||[],this.missed=[[]],this.hits=[],this.allow=!1,this.name=""}initialize(e){for(let t=0;t<10;t++){this.board[t]=[];for(let r=0;r<10;r++)this.board[t][r]=e,e++}}placeShip(e){let t=e.column,r=e.position;for(let e=0;e<r.length;e++)for(let n=0;n<r.length;n++)this.board[t[e]][this.board[t[e]].indexOf(r[n])]="x"}recieveAttack(e){this.hits.push(e)}allowAttack(){return this.allow}instanceName(){return this}}class t{constructor(){this.turn=!0,this.position=this.position}autoPlay(e){return e[Math.floor(100*Math.random())]}}class r{constructor(e,t,r){this.length=e,this.hits=[],this.position=r||[],this.column=t||[]}hit(e){this.hits.push(e)}allShipSunk(){return 16===this.hits.length}}const n=(e,t,r,n)=>{const a=document.querySelector(t);e.board.forEach((e=>{e.forEach((e=>{const t=document.createElement("div");t.classList.add(r),t.classList.add(n),t.setAttribute("value",e),a.appendChild(t),t.value=e,t.textContent=e}))}))},a=(e,t,r,n)=>{o(t,r);const a=document.querySelector(`#${t}`);e.board.forEach((e=>{e.forEach((e=>{const t=document.createElement("div");t.classList.add(r),t.classList.add(n),t.setAttribute("value",e),a.appendChild(t),t.value=e,t.textContent=e}))}))},o=(e,t)=>{const r=document.querySelector(`#${e}`);document.querySelectorAll(`.${t}`).forEach((e=>{r.removeChild(e)}))},l=(e,t,r)=>{let n=[6,7,8,9],a=[7,8,9],o=[8,9],l=[9];if(1===r)switch(!0){case 5===e.length&&n.includes(t.target.value%10):case 4===e.length&&a.includes(t.target.value%10):case 3===e.length&&o.includes(t.target.value%10):case 2===e.length&&l.includes(t.target.value%10):return!0}if(10===r)switch(!0){case 5===e.length&&n.includes(Math.floor(t.target.value/10)):case 4===e.length&&a.includes(Math.floor(t.target.value/10)):case 3===e.length&&o.includes(Math.floor(t.target.value/10)):case 2===e.length&&l.includes(Math.floor(t.target.value/10)):return!0}},i=(e,t,r,n)=>{let a=[];if(1!==e.length){for(let o=0;o<=(e.length-1)*n;o+=n){if(l(e,t,n))return;if(t.target.value+o=="x0")return;if(null===document.querySelector(`div[value="${t.target.value+o}"]`))return;if(t.target.value+o=="x0")return;document.querySelector(`div[value="${t.target.value+o}"]`).style.backgroundColor=r,a.push(t.target.value+o)}return a}};let c=!0,s="horizontal",u=1;const d=document.querySelector("#rotate"),h=(e,t,n)=>{let o=document.querySelectorAll(`.player-grids.${s}`);const l=new r(t,[0,0,0],[1,2,3]);3===t&&c&&(t+=1,c=!1),t<=1?g(e):(o.forEach((r=>r.addEventListener("mouseover",(n=>{i(l,n,"lightblue",u),r.addEventListener("click",(r=>{l.position=i(l,r,"gray",u),l.column=(e=>{let t=[];for(let r=0;r<=e.length-1;r++)e.position[r]&&t.push(Math.floor(e.position[r]/10));return t})(l),e.placeShip(l),a(e,"primary-container","player-grids",s),Array.from(document.querySelectorAll(".player-grids")).filter((e=>"x"===e.value)).forEach((e=>e.style.backgroundColor="lightblue")),h(e,t-1)}))})))),o.forEach((e=>e.addEventListener("mouseout",(e=>{i(l,e,"rgb(232 230 230)",u)})))))},g=r=>{let n,a,o,l=new e;l.name="aiBoard";const i=document.querySelectorAll(".player-grids");document.querySelectorAll(".ai-grids").forEach((e=>e.addEventListener("click",(c=>{const s=c.target.value;n=new t,a=n.autoPlay(i),o=a.value,"x"===s?(l.recieveAttack(s),p(l),e.style.backgroundColor="rgb(248, 78, 49 )",v(a,o,r)):(e.style.backgroundColor="lightgreen",v(a,o,r))}))))},v=(e,t,r)=>{e.addEventListener("click",(n=>{const a=n.target.value;"x"===t?(r.recieveAttack(t),p(r),e.style.backgroundColor="rgb(248, 78, 49 )",r.recieveAttack(a)):e.style.backgroundColor="lightgreen"}));const n=new Event("click");e.dispatchEvent(n)};d.addEventListener("click",(e=>{"horizontal"===s?(s="vertical",u=10):"vertical"===s&&(s="horizontal",u=1)}));const p=e=>{let t="";if(16===e.hits.length){t="aiBoard"===e.name?"You":"Computer";const r=document.querySelector(".winner-container");r.classList.add("show"),r.firstElementChild.textContent=`${t} Won!!`,r.addEventListener("click",(e=>{e.target instanceof HTMLButtonElement&&location.reload()}))}};(()=>{new t,new t;const o=new e,l=new e;o.initialize(0),l.initialize(100),n(o,"#primary-container","player-grids","horizontal"),n(l,"#secondary-container","ai-grids","horizontal"),(e=>{const t=new r(5,[0,0,0,0,0],[101,102,103,104,105]),n=new r(4,[7,7,7,7],[173,174,175,176]),o=new r(3,[2,2,2],[122,123,124]),l=new r(3,[4,4,4],[144,145,146]),i=new r(2,[8,9],[181,191]);e.placeShip(t),a(e,"secondary-container","ai-grids","horizontal"),e.placeShip(n),a(e,"secondary-container","ai-grids","horizontal"),e.placeShip(o),a(e,"secondary-container","ai-grids","horizontal"),e.placeShip(l),a(e,"secondary-container","ai-grids","horizontal"),e.placeShip(i),a(e,"secondary-container","ai-grids","horizontal")})(l),h(o,5,l)})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFFLENBQUMsRUFBRSxFQUFFLEdBQUcsQ0FBQyxJQUFJLElBQUksTUFDcEMwRSxFQUFRLElBQUkxRSxFQUFLLEVBQUUsQ0FBQyxFQUFFLEVBQUUsR0FBRyxDQUFDLElBQUksSUFBSSxNQUNwQzJFLEVBQVEsSUFBSTNFLEVBQUssRUFBRSxDQUFDLEVBQUUsR0FBRyxDQUFDLElBQUksTUFFcEM4QyxFQUFVL0QsVUFBVUMsR0FDcEJzQyxFQUFZd0IsRUFBVSxzQkFBc0IsV0FBVyxjQUN2REEsRUFBVS9ELFVBQVV5RixHQUNwQmxELEVBQVl3QixFQUFVLHNCQUFzQixXQUFXLGNBQ3ZEQSxFQUFVL0QsVUFBVTBGLEdBQ3BCbkQsRUFBWXdCLEVBQVUsc0JBQXNCLFdBQVcsY0FDdkRBLEVBQVUvRCxVQUFVMkYsR0FDcEJwRCxFQUFZd0IsRUFBVSxzQkFBc0IsV0FBVyxjQUN2REEsRUFBVS9ELFVBQVU0RixHQUNwQnJELEVBQVl3QixFQUFVLHNCQUFzQixXQUFXLGFBQWEsRUMvVHBFOEIsQ0FBYzdCLEdBRWRGLEVBQWtCVyxFQUFZLEVBQUVULEVBQVEsRUFxQjVDOEIsRSIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZmFjdG9yaWVzL0dhbWVCb2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2ZhY3Rvcmllcy9QbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9mYWN0b3JpZXMvU2hpcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3NjcmlwdHMvZG9tLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvc2NyaXB0cy9tYWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbWVCb2FyZCB7XG4gIGNvbnN0cnVjdG9yKGJvYXJkKSB7XG4gICAgdGhpcy5ib2FyZCA9IGJvYXJkIHx8IFtdO1xuICAgIHRoaXMubWlzc2VkID0gW1tdXTtcbiAgICB0aGlzLmhpdHMgPSBbXTtcbiAgICB0aGlzLmFsbG93ID0gZmFsc2U7XG4gICAgdGhpcy5uYW1lID0gJyc7XG4gIH1cblxuICBpbml0aWFsaXplKGNvdW50KSB7XG4gICAgXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICB0aGlzLmJvYXJkW2ldID0gW107XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDEwOyBqKyspIHtcbiAgICAgICAgdGhpcy5ib2FyZFtpXVtqXSA9IGNvdW50O1xuICAgICAgICBjb3VudCsrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBcblxuXG4gIHBsYWNlU2hpcChzaGlwKSB7XG4gICAgbGV0IGNvbHVtbiA9IHNoaXAuY29sdW1uO1xuICAgIGxldCBwb3NpdGlvbiA9IHNoaXAucG9zaXRpb247XG4gICAgXG4gICBcbiAgICBmb3IobGV0IGk9MDsgaTxwb3NpdGlvbi5sZW5ndGg7aSsrKXtcbiAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHBvc2l0aW9uLmxlbmd0aDsgaisrKSB7XG4gICAgICAgIC8vIGlmKCh0aGlzLmJvYXJkW2NvbHVtbltpXSsxXVt0aGlzLmJvYXJkW2NvbHVtbltpXSsxXS5pbmRleE9mKHBvc2l0aW9uW2pdKzEwKV0pIT0neCcpe1xuICAgICAgICAgIHRoaXMuYm9hcmRbY29sdW1uW2ldXVt0aGlzLmJvYXJkW2NvbHVtbltpXV0uaW5kZXhPZihwb3NpdGlvbltqXSldID0gJ3gnO1xuICAgICAgICBcbiAgICAgICAgLy8gfVxuICAgIH1cbiAgIH1cbiAgIFxuICB9XG4gIFxuIFxuICBcbiAgcmVjaWV2ZUF0dGFjayhwb3NpdGlvbil7XG4gICAgXG4gICAgICAgIHRoaXMuaGl0cy5wdXNoKHBvc2l0aW9uKTtcbiAgICBcbiAgfVxuXG4gIGFsbG93QXR0YWNrKCl7XG4gICAgcmV0dXJuIHRoaXMuYWxsb3c7XG4gIH1cblxuICBpbnN0YW5jZU5hbWUoKSB7cmV0dXJuIHRoaXN9XG4gIC8vIHJlY2lldmVBdHRhY2soY29sdW1uLCBwb3NpdGlvbikge1xuICAvLyAgIGZvcihsZXQgaT0wOyBpPHBvc2l0aW9uLmxlbmd0aDsgaSsrKXtcbiAgLy8gICAgIGZvcihsZXQgaj0wOyBqPHBvc2l0aW9uLmxlbmd0aDsgaisrKXtcbiAgLy8gICAgICAgaWYgKHRoaXMuYm9hcmRbY29sdW1uW2ldXVtwb3NpdGlvbltqXV0gPT09IFwieFwiKSB7XG4gIC8vICAgICAgICAgaWYgKHRoaXMuaGl0c1tjb2x1bW5baV1dID09PSB1bmRlZmluZWQpIHtcbiAgLy8gICAgICAgdGhpcy5oaXRzW2NvbHVtbltpXV0gPSBbcG9zaXRpb25bal1dO1xuICAvLyAgICAgfSBlbHNlIHtcbiAgLy8gICAgICAgdGhpcy5oaXRzW2NvbHVtbltpXV0ucHVzaChwb3NpdGlvbltpXSk7XG4gIC8vICAgICB9XG4gIC8vICAgfSBlbHNlIGlmICh0aGlzLm1pc3NlZFtjb2x1bW5dID09PSB1bmRlZmluZWQpIHtcbiAgLy8gICAgIHRoaXMubWlzc2VkW2NvbHVtbl0gPSBbcG9zaXRpb25dO1xuICAvLyAgIH0gZWxzZSB7XG4gIC8vICAgICB0aGlzLm1pc3NlZFtjb2x1bW5dLnB1c2gocG9zaXRpb24pO1xuICAvLyAgIH1cbiAgLy8gICAgIH1cbiAgLy8gICB9XG4gICAgXG4gIC8vIH1cbiBcbn1cbiIsImV4cG9ydCBjbGFzcyBQbGF5ZXJ7XG4gICAgY29uc3RydWN0b3IoKXsgXG4gICAgICAgIHRoaXMudHVybiA9IHRydWU7XG4gICAgICAgIHRoaXMucG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uO1xuICAgIH1cbiAgXG4gICAgYXV0b1BsYXkoZ3JpZCl7XG4gICAgICAgIFxuICAgICAgICBsZXQgcmFuZG9tID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjEwMCk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZ3JpZFtyYW5kb21dO1xuICAgIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTaGlwe1xuICAgIGNvbnN0cnVjdG9yKGxlbmd0aCxjb2x1bW4scG9zaXRpb24pe1xuICAgICAgICB0aGlzLmxlbmd0aCA9IGxlbmd0aDtcbiAgICAgICAgdGhpcy5oaXRzID0gW107XG4gICAgICAgIHRoaXMucG9zaXRpb24gPSBwb3NpdGlvbnx8W107XG4gICAgICAgIHRoaXMuY29sdW1uID0gY29sdW1ufHxbXTtcbiAgICAgICBcbiAgICB9XG4gICAgaGl0KGhpdFBvc2l0aW9uKXtcbiAgICAgICAgLy8gaWYodGhpcy5wb3NpdGlvbi5pbmNsdWRlcyhoaXRQb3NpdGlvbikmJiAhKHRoaXMuaGl0cy5pbmNsdWRlcyhoaXRQb3NpdGlvbikpKXtcbiAgICAgICAgICAgIHRoaXMuaGl0cy5wdXNoKGhpdFBvc2l0aW9uKTtcbiAgICAgICAgLy99XG4gICAgICAgIFxuICAgIH1cblxuICAgIGFsbFNoaXBTdW5rKCl7XG4gICAgICAgIGlmKHRoaXMuaGl0cy5sZW5ndGg9PT0xNil7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG4iLCJpbXBvcnQgR2FtZUJvYXJkIGZyb20gXCIuLi9mYWN0b3JpZXMvR2FtZUJvYXJkXCI7XG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi4vZmFjdG9yaWVzL1BsYXllclwiO1xuaW1wb3J0IFNoaXAgZnJvbSBcIi4uL2ZhY3Rvcmllcy9TaGlwXCI7XG5cblxuLy8gVE9ETzogXG5cbmV4cG9ydCBjb25zdCBjcmVhdGVCb2FyZCA9IChuZXdCb2FyZCxpZCxjbGFzc05hbWUsZGlyZWN0aW9uKT0+e1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoaWQpO1xuICAgIFxuICAgIGxldCBib2FyZCA9IG5ld0JvYXJkLmJvYXJkO1xuICAgIFxuICAgIGJvYXJkLmZvckVhY2goZT0+e1xuICAgICAgICBlLmZvckVhY2goZT0+e1xuICAgICAgICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpOyBcbiAgICAgICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKGRpcmVjdGlvbik7IFxuICAgICAgICAgICAgZGl2LnNldEF0dHJpYnV0ZSgndmFsdWUnLGUpO1xuICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGRpdik7XG4gICAgICAgICAgICBkaXYudmFsdWUgPSBlO1xuICAgICAgICAgICAgZGl2LnRleHRDb250ZW50ID0gZTtcbiAgICAgICAgICAgIFxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydCBjb25zdCB1cGRhdGVCb2FyZCA9IChuZXdCb2FyZCxjb250YWluZXJJRCxncmlkSUQsZGlyZWN0aW9uKT0+e1xuICAgIHJlbW92ZUJvYXJkKGNvbnRhaW5lcklELGdyaWRJRCk7XG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7Y29udGFpbmVySUR9YCk7XG4gICAgbGV0IGJvYXJkID0gbmV3Qm9hcmQuYm9hcmQ7XG4gICAgYm9hcmQuZm9yRWFjaChlPT57XG4gICAgICAgIGUuZm9yRWFjaChlPT57XG4gICAgICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKGdyaWRJRCk7IFxuICAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZChkaXJlY3Rpb24pOyBcbiAgICAgICAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJyxlKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChkaXYpO1xuICAgICAgICAgICAgZGl2LnZhbHVlID0gZTtcbiAgICAgICAgICAgIGRpdi50ZXh0Q29udGVudCA9IGU7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIFxuICAgICAgICB9KTtcbiAgICAgICAgIFxuICAgIH0pO1xuXG4gICAgXG59XG5leHBvcnQgY29uc3QgcmVtb3ZlQm9hcmQgPSAoY29udGFpbmVySUQsZ3JpZElEKT0+e1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2NvbnRhaW5lcklEfWApO1xuICAgIGNvbnN0IGdyaWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAuJHtncmlkSUR9YCk7XG4gICAgZ3JpZC5mb3JFYWNoKGVsZW1lbnQ9PiB7IFxuICAgICAgICAgICAgXG4gICAgICAgICBjb250YWluZXIucmVtb3ZlQ2hpbGQoZWxlbWVudClcbiAgICAgIFxuICAgICAgIFxuICAgIH0pO1xufVxuZXhwb3J0IGNvbnN0IGNsaWNrRXZlbnQgPSAocGxheWVyLGFpKT0+e1xuICAgIGNvbnN0IGdyaWRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmdyaWRzJyk7XG4gICAgZ3JpZHMuZm9yRWFjaChlbGVtZW50PT5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSk9PntcbiAgICAgICAgaWYocGxheWVyLnR1cm4pe1xuICAgICAgICAgICAgIGFpLnR1cm4gPSB0cnVlO1xuICAgICAgICAgICAgIHBsYXllci50dXJuID0gZmFsc2U7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICBjb25zdCBldmVudCA9IG5ldyBFdmVudCgnY2xpY2snKTtcbiAgICAgICAgICAgIGVsZW1lbnQuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgIH1lbHNlIGlmKGFpLnR1cm4pe1xuICAgICAgICAgICAgYWkudHVybiA9IGZhbHNlO1xuICAgICAgICAgICAgcGxheWVyLnR1cm4gPSB0cnVlO1xuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfSkpO1xufVxuXG5jb25zdCBjaGVja0lmT3V0T2ZCb3VuZCA9IChzaGlwLGV2ZW50LGluY3JlbWVudCk9PntcbiAgICBsZXQgb3V0T2ZCb3VuZDUgPSBbNiw3LDgsOV07XG4gICAgIGxldCBvdXRPZkJvdW5kNCA9IFs3LDgsOV07XG4gICAgIGxldCBvdXRPZkJvdW5kMyA9IFs4LDldO1xuICAgICBsZXQgb3V0T2ZCb3VuZDIgPSBbOV07XG4gICAgXG4gICAgaWYoaW5jcmVtZW50ID09PTEpe1xuICAgICAgICBzd2l0Y2godHJ1ZSl7IFxuICAgICAgICAgICAgIGNhc2Ugc2hpcC5sZW5ndGg9PT01ICYmIG91dE9mQm91bmQ1LmluY2x1ZGVzKGV2ZW50LnRhcmdldC52YWx1ZSUxMCk6XG4gICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgIGNhc2Ugc2hpcC5sZW5ndGg9PT00ICYmIG91dE9mQm91bmQ0LmluY2x1ZGVzKGV2ZW50LnRhcmdldC52YWx1ZSUxMCk6XG4gICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgIGNhc2Ugc2hpcC5sZW5ndGg9PT0zICYmIG91dE9mQm91bmQzLmluY2x1ZGVzKGV2ZW50LnRhcmdldC52YWx1ZSUxMCk6XG4gICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgIGNhc2Ugc2hpcC5sZW5ndGg9PT0yICYmIG91dE9mQm91bmQyLmluY2x1ZGVzKGV2ZW50LnRhcmdldC52YWx1ZSUxMCk6XG4gICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBcbiAgICAgfVxuICAgICBpZihpbmNyZW1lbnQgPT09MTApe1xuICAgICAgICAgc3dpdGNoKHRydWUpeyBcbiAgICAgICAgICAgICAgY2FzZSBzaGlwLmxlbmd0aD09PTUgJiYgb3V0T2ZCb3VuZDUuaW5jbHVkZXMoTWF0aC5mbG9vcihldmVudC50YXJnZXQudmFsdWUvMTApKTpcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09NCAmJiBvdXRPZkJvdW5kNC5pbmNsdWRlcyhNYXRoLmZsb29yKGV2ZW50LnRhcmdldC52YWx1ZS8xMCkpOlxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgIGNhc2Ugc2hpcC5sZW5ndGg9PT0zICYmIG91dE9mQm91bmQzLmluY2x1ZGVzKE1hdGguZmxvb3IoZXZlbnQudGFyZ2V0LnZhbHVlLzEwKSk6XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgY2FzZSBzaGlwLmxlbmd0aD09PTIgJiYgb3V0T2ZCb3VuZDIuaW5jbHVkZXMoTWF0aC5mbG9vcihldmVudC50YXJnZXQudmFsdWUvMTApKTpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgfSBcbiAgICAgIH1cbn1cbmNvbnN0IGdldENvb3JkaW5hdGVzID0gKHNoaXAsZXZlbnQsY29sb3IsaW5jcmVtZW50KT0+e1xuICBcblxuICBsZXQgY29vcmRpbmF0ZSA9IFtdO1xuICBpZiAoc2hpcC5sZW5ndGggPT09IDEpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgZm9yIChsZXQgaSA9IDA7IGkgPD0gKHNoaXAubGVuZ3RoIC0gMSkgKiBpbmNyZW1lbnQ7IGkgPSBpICsgaW5jcmVtZW50KSB7XG4gICAgIGlmKGNoZWNrSWZPdXRPZkJvdW5kKHNoaXAsZXZlbnQsaW5jcmVtZW50KSkgcmV0dXJuO1xuICAgXG4gICAgXG4gICAgaWYgKGV2ZW50LnRhcmdldC52YWx1ZSArIGkgPT0gXCJ4MFwiKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYGRpdlt2YWx1ZT1cIiR7ZXZlbnQudGFyZ2V0LnZhbHVlICsgaX1cIl1gKSA9PT0gbnVsbFxuICAgICkge1xuICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlICsgaSA9PSBcIngwXCIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYGRpdlt2YWx1ZT1cIiR7ZXZlbnQudGFyZ2V0LnZhbHVlICsgaX1cIl1gXG4gICAgKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcjtcbiAgICBjb29yZGluYXRlLnB1c2goZXZlbnQudGFyZ2V0LnZhbHVlICsgaSk7XG4gIH1cbiAgcmV0dXJuIGNvb3JkaW5hdGU7XG59XG5jb25zdCBnZXRDb2x1bW5zID0gKHNoaXApPT57XG4gICAgbGV0IGNvbHVtbnMgPSBbXTtcbiAgICBmb3IobGV0IGkgPSAwOyBpPD1zaGlwLmxlbmd0aC0xOyBpKyspe1xuICAgICAgICBcbiAgICAgICAgICAgaWYoc2hpcC5wb3NpdGlvbltpXSl7XG4gICAgICAgICAgICAgY29sdW1ucy5wdXNoKE1hdGguZmxvb3IoKHNoaXAucG9zaXRpb25baV0pLzEwKSk7XG4gICAgICAgIH0gIFxuICAgICAgIFxuICAgICAgICAgICBcbiAgICAgICAgXG4gICAgICAgXG4gICAgfVxuICBcbiAgICByZXR1cm4gY29sdW1ucztcbn1cbmNvbnN0IGNoYW5nZUNvbG9yID0gKCkgPT57XG4gICAgY29uc3Qgc2VsZWN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGxheWVyLWdyaWRzJykpO1xuICAgIHNlbGVjdC5maWx0ZXIoZWxlbWVudD0+ZWxlbWVudC52YWx1ZT09PSd4JykuZm9yRWFjaChlbGVtZW50PT5lbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdsaWdodGJsdWUnKTtcbiAgICBcbiAgICBcbn1cbmxldCBmbGFnID0gdHJ1ZTtcbiBsZXQgZGlyZWN0aW9uID0gJ2hvcml6b250YWwnO1xuIGxldCBpbmNyZW1lbnQgPSAxO1xuIGNvbnN0IHJvdGF0ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNyb3RhdGUnKTtcblxuZXhwb3J0IGNvbnN0IHJlbmRlclBsYXllclNoaXBzID0gICAoZ2FtZWJvYXJkLGxlbmd0aCxhaUJvYXJkKSA9PntcbiAgICAgXG4gICAgXG4gICAgXG4gICAgbGV0IGdyaWRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLnBsYXllci1ncmlkcy4ke2RpcmVjdGlvbn1gKTtcbiAgICBcbiAgICBcbiAgICBjb25zdCBzaGlwID0gbmV3IFNoaXAobGVuZ3RoLFswLDAsMF0sWzEsMiwzXSk7XG4gICAgXG4gICAgaWYobGVuZ3RoPT09Myl7XG4gICAgICAgIGlmKGZsYWcpe1xuICAgICAgICAgICBsZW5ndGgrPTE7IFxuICAgICAgICAgICBmbGFnPWZhbHNlO1xuICAgICAgICB9IFxuICAgIH1cbiAgICBpZihsZW5ndGg8PTEpe1xuICAgICAgICBcbiAgICAgIFxuICAgICAgIFxuICAgICAgIHJlbmRlckF0dGFjayhnYW1lYm9hcmQpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgICBcbiAgICBncmlkcy5mb3JFYWNoKGVsZW1lbnQ9PmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywoZSk9PntcbiAgICAgICAgICAgICBnZXRDb29yZGluYXRlcyhzaGlwLGUsJ2xpZ2h0Ymx1ZScsaW5jcmVtZW50KTtcbiAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKGUpPT57XG4gICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgIHNoaXAucG9zaXRpb24gPSBnZXRDb29yZGluYXRlcyhzaGlwLGUsJ2dyYXknLGluY3JlbWVudCk7XG4gICAgICAgICAgICAgICBzaGlwLmNvbHVtbiA9IGdldENvbHVtbnMoc2hpcCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcCk7XG4gICAgICAgICAgICAgICAgICAgICB1cGRhdGVCb2FyZChnYW1lYm9hcmQsJ3ByaW1hcnktY29udGFpbmVyJyxcInBsYXllci1ncmlkc1wiLGRpcmVjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgY2hhbmdlQ29sb3IoKTtcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZW5kZXJQbGF5ZXJTaGlwcyhnYW1lYm9hcmQsbGVuZ3RoLTEpO1xuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICBcbiAgICB9KSk7XG4gICAgXG5cbiAgICBncmlkcy5mb3JFYWNoKGVsZW1lbnQ9PmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLChlKT0+e1xuICAgICAgICBnZXRDb29yZGluYXRlcyhzaGlwLGUsJ3JnYigyMzIgMjMwIDIzMCknLGluY3JlbWVudCk7XG4gICAgfSkpOyAgXG4gICAgXG4gICBcbiAgIFxufVxuXG5cbmV4cG9ydCBjb25zdCByZW5kZXJBdHRhY2sgPSAocGxheWVyQm9hcmQpID0+e1xuICAgbGV0IGFpQm9hcmQgPSBuZXcgR2FtZUJvYXJkKCk7XG4gICBhaUJvYXJkLm5hbWUgPSAnYWlCb2FyZCc7XG4gICAgbGV0IGFpO1xuICAgIGxldCByYW5kb21seVBpY2tlZEdyaWQ7XG4gICAgbGV0IGdyaWRWYWx1ZTtcbiAgICBjb25zdCBwbGF5ZXJHcmlkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wbGF5ZXItZ3JpZHMnKTtcbiAgICBjb25zdCBhaUdyaWRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmFpLWdyaWRzJyk7XG4gICBcbiAgICBcbiAgICBcbiAgICAgICAgXG4gICAgICAgIGFpR3JpZHMuZm9yRWFjaChlbGVtZW50PT5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSk9PntcbiAgICAgICAgICAgICAgY29uc3QgZWxlbWVudFZhbHVlID0gZS50YXJnZXQudmFsdWU7XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICBhaSA9IG5ldyBQbGF5ZXIoKTtcbiAgICAgICAgICAgICAgcmFuZG9tbHlQaWNrZWRHcmlkID0gYWkuYXV0b1BsYXkocGxheWVyR3JpZHMpO1xuICAgICAgICAgICAgICBncmlkVmFsdWUgPSByYW5kb21seVBpY2tlZEdyaWQudmFsdWU7XG4gICAgICAgICAgICAgXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmKGVsZW1lbnRWYWx1ZSA9PT0gJ3gnKXtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBhaUJvYXJkLnJlY2lldmVBdHRhY2soZWxlbWVudFZhbHVlKTtcbiAgICAgICAgICAgICAgICBjaGVja0lmV29uKGFpQm9hcmQpO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3JnYigyNDgsIDc4LCA0OSApJztcbiAgICAgICAgICAgICAgICByZW5kZXJBaUF0dGFjayhyYW5kb21seVBpY2tlZEdyaWQsZ3JpZFZhbHVlLHBsYXllckJvYXJkKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2xpZ2h0Z3JlZW4nO1xuICAgICAgICAgICAgICAgIHJlbmRlckFpQXR0YWNrKHJhbmRvbWx5UGlja2VkR3JpZCxncmlkVmFsdWUscGxheWVyQm9hcmQpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIH0pKTtcbiAgICAgICAgXG4gICAgICAgIFxuICAgIFxuICAgIH1cbmNvbnN0IHJlbmRlckFpQXR0YWNrID0gKHJhbmRvbWx5UGlja2VkR3JpZCxncmlkVmFsdWUscGxheWVyQm9hcmQpPT57XG4gICAgcmFuZG9tbHlQaWNrZWRHcmlkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSk9PntcbiAgICAgICAgY29uc3QgZWxlbWVudFZhbHVlID0gZS50YXJnZXQudmFsdWU7XG4gICAgICAgIGlmKGdyaWRWYWx1ZT09PSAneCcpe1xuICAgICAgICAgICAgcGxheWVyQm9hcmQucmVjaWV2ZUF0dGFjayhncmlkVmFsdWUpO1xuICAgICAgICAgICAgY2hlY2tJZldvbihwbGF5ZXJCb2FyZCk7XG4gICAgICAgICAgICByYW5kb21seVBpY2tlZEdyaWQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3JnYigyNDgsIDc4LCA0OSApJztcbiAgICAgICAgICAgIHBsYXllckJvYXJkLnJlY2lldmVBdHRhY2soZWxlbWVudFZhbHVlKVxuICAgICAgICAgICBcblxuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgXG4gICAgICAgICAgICAgcmFuZG9tbHlQaWNrZWRHcmlkLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdsaWdodGdyZWVuJztcbiAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgfSk7XG4gICAgICBjb25zdCBldmVudCA9IG5ldyBFdmVudCgnY2xpY2snKTtcbiAgICAgcmFuZG9tbHlQaWNrZWRHcmlkLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xufVxuXG5leHBvcnQgY29uc3QgcmVuZGVyUGxheWVyQXR0YWNrID0gKGJvYXJkKT0+e1xuICAgIGNvbnN0IGFpR3JpZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYWktZ3JpZHMnKTtcbiAgICBhaUdyaWRzLmZvckVhY2goZWxlbWVudD0+ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKGUpPT57XG4gICAgICAgIGlmKGUudGFyZ2V0LnZhbHVlID09PSAneCcpe1xuICAgICAgICAgICAgYm9hcmQucmVjaWV2ZUF0dGFjayhlLnRhcmdldC52YWx1ZSk7XG4gICAgICAgICAgICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZ2IoMjQ4LCA3OCwgNDkgKSc7XG4gICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2xpZ2h0Z3JlZW4nO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgIH0pKTtcbn1cblxuIHJvdGF0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKGUpPT57XG4gICAgICBcbiAgICAgICAgaWYoZGlyZWN0aW9uID09PSdob3Jpem9udGFsJyl7XG4gICAgICAgICAgICBkaXJlY3Rpb24gPSAndmVydGljYWwnO1xuICAgICAgICAgICAgaW5jcmVtZW50ID0gMTA7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIFxuICAgICAgICB9ZWxzZSBpZihkaXJlY3Rpb24gPT09J3ZlcnRpY2FsJyl7XG4gICAgICAgICAgICBkaXJlY3Rpb24gPSAnaG9yaXpvbnRhbCc7XG4gICAgICAgICAgICBpbmNyZW1lbnQgPSAxO1xuICAgICAgICAgICBcbiAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBcbiAgICB9KTtcblxuXG5jb25zdCBjaGVja0lmV29uID0gKGJvYXJkKT0+e1xuICAgIGxldCBib2FyZE5hbWUgPSAnJztcbiAgICBpZihib2FyZC5oaXRzLmxlbmd0aCA9PT0xNil7XG4gICAgICAgICAgYm9hcmROYW1lID0gIGJvYXJkLm5hbWUgPT09ICdhaUJvYXJkJyA/ICdZb3UnIDogJ0NvbXB1dGVyJztcbiAgICAgIFxuICAgICAgICBjb25zdCB3aW5uZXJDb250YWluZXI9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53aW5uZXItY29udGFpbmVyJyk7XG4gICAgICAgIHdpbm5lckNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7XG4gICAgICAgIHdpbm5lckNvbnRhaW5lci5maXJzdEVsZW1lbnRDaGlsZC50ZXh0Q29udGVudCA9IGAke2JvYXJkTmFtZX0gV29uISFgO1xuICAgICAgICB3aW5uZXJDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLChlKT0+e1xuICAgICAgICAgICAgaWYoZS50YXJnZXQgaW5zdGFuY2VvZiBIVE1MQnV0dG9uRWxlbWVudCl7XG4gICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgfSlcbiAgICAgIH1cbn1cblxuXG5leHBvcnQgY29uc3QgcmVuZGVyQWlTaGlwcyA9ICAoZ2FtZWJvYXJkKSA9PntcbiAgICBjb25zdCBzaGlwID0gbmV3IFNoaXAoNSxbMCwwLDAsMCwwXSxbMTAxLDEwMiwxMDMsMTA0LDEwNV0pO1xuICAgIGNvbnN0IHNoaXAyID0gbmV3IFNoaXAoNCxbNyw3LDcsN10sWzE3MywxNzQsMTc1LDE3Nl0pO1xuICAgIGNvbnN0IHNoaXAzID0gbmV3IFNoaXAoMyxbMiwyLDJdLFsxMjIsMTIzLDEyNF0pO1xuICAgIGNvbnN0IHNoaXA0ID0gbmV3IFNoaXAoMyxbNCw0LDRdLFsxNDQsMTQ1LDE0Nl0pO1xuICAgIGNvbnN0IHNoaXA1ID0gbmV3IFNoaXAoMixbOCw5XSxbMTgxLDE5MV0pO1xuICAgIFxuICAgIGdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcCk7XG4gICAgdXBkYXRlQm9hcmQoZ2FtZWJvYXJkLCdzZWNvbmRhcnktY29udGFpbmVyJyxcImFpLWdyaWRzXCIsXCJob3Jpem9udGFsXCIpO1xuICAgIGdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcDIpO1xuICAgIHVwZGF0ZUJvYXJkKGdhbWVib2FyZCwnc2Vjb25kYXJ5LWNvbnRhaW5lcicsXCJhaS1ncmlkc1wiLFwiaG9yaXpvbnRhbFwiKTtcbiAgICBnYW1lYm9hcmQucGxhY2VTaGlwKHNoaXAzKTtcbiAgICB1cGRhdGVCb2FyZChnYW1lYm9hcmQsJ3NlY29uZGFyeS1jb250YWluZXInLFwiYWktZ3JpZHNcIixcImhvcml6b250YWxcIik7XG4gICAgZ2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwNCk7XG4gICAgdXBkYXRlQm9hcmQoZ2FtZWJvYXJkLCdzZWNvbmRhcnktY29udGFpbmVyJyxcImFpLWdyaWRzXCIsXCJob3Jpem9udGFsXCIpO1xuICAgIGdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcDUpO1xuICAgIHVwZGF0ZUJvYXJkKGdhbWVib2FyZCwnc2Vjb25kYXJ5LWNvbnRhaW5lcicsXCJhaS1ncmlkc1wiLFwiaG9yaXpvbnRhbFwiKTtcbiAgICBcbn1cblxuXG5cbiIsImltcG9ydCBHYW1lQm9hcmQgZnJvbSBcIi4uL2ZhY3Rvcmllcy9HYW1lQm9hcmRcIjtcbmltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuLi9mYWN0b3JpZXMvUGxheWVyXCJcbmltcG9ydCBTaGlwIGZyb20gXCIuLi9mYWN0b3JpZXMvU2hpcFwiO1xuaW1wb3J0IHsgY2xpY2tFdmVudCwgY3JlYXRlQm9hcmQsIHJlbW92ZUJvYXJkLCByZW5kZXJBaVNoaXBzLCByZW5kZXJBdHRhY2ssIHJlbmRlclBsYXllclNoaXBzLCB1cGRhdGVCb2FyZCAsIHJlbmRlckFpQXR0YWNrfSBmcm9tIFwiLi9kb21cIjtcblxuZXhwb3J0IGNvbnN0IHJ1bkdhbWUgPSAoKT0+e1xuICAgIGNvbnN0IHBsYXllciA9IG5ldyBQbGF5ZXIoKTtcbiAgICBjb25zdCBhaSA9IG5ldyBQbGF5ZXIoKTtcbiAgIFxuXG4gICAgY29uc3QgcGxheWVyQm9hcmQgPSBuZXcgR2FtZUJvYXJkKCk7XG4gICAgY29uc3QgYWlCb2FyZCA9IG5ldyBHYW1lQm9hcmQoKTtcbiAgICBwbGF5ZXJCb2FyZC5pbml0aWFsaXplKDApO1xuICAgIGFpQm9hcmQuaW5pdGlhbGl6ZSgxMDApO1xuICAgIFxuICAgIGNyZWF0ZUJvYXJkKHBsYXllckJvYXJkLCcjcHJpbWFyeS1jb250YWluZXInLCdwbGF5ZXItZ3JpZHMnLCdob3Jpem9udGFsJyk7XG4gICAgY3JlYXRlQm9hcmQoYWlCb2FyZCwnI3NlY29uZGFyeS1jb250YWluZXInLCdhaS1ncmlkcycsJ2hvcml6b250YWwnKTtcbiAgICAvL2NvbnNvbGUubG9nKGFpQm9hcmQpO1xuICAgIHJlbmRlckFpU2hpcHMoYWlCb2FyZCk7XG4gICAgLy9jb25zb2xlLmxvZyhhaUJvYXJkKTtcbiAgICByZW5kZXJQbGF5ZXJTaGlwcyhwbGF5ZXJCb2FyZCw1LGFpQm9hcmQpOyBcbiAgLy8gIGNvbnNvbGUubG9nKGFpQm9hcmQpO1xuICAgICAgIFxuICAgIC8vICByZW5kZXJBdHRhY2soYWlCb2FyZCxwbGF5ZXJCb2FyZCk7XG4gICAgXG4gICBcbiAgICBcbiAgICAvLyByZW5kZXJTaGlwcyhnYW1lYm9hcmQsNCk7XG4gICAvLyB1cGRhdGVCb2FyZChnYW1lYm9hcmQsJ3ByaW1hcnktY29udGFpbmVyJyxcInBsYXllci1ncmlkc1wiKTtcbiAgICAgXG4gICAgLy8gZm9yKGxldCBpID0wO2k8NDsgaSsrKXtcbiAgICAgICBcbiAgICAvLyAgICAgcmVuZGVyU2hpcHMoZ2FtZWJvYXJkLDQpO1xuICAgIC8vIH1cbiAgICAgXG4gICAgXG5cbiAgIFxuICAgIC8vICBjb25zb2xlLmxvZyhnYW1lYm9hcmQuYm9hcmQpO1xuICAgIC8vICBjbGlja0V2ZW50KHBsYXllcixhaSk7XG59XG5ydW5HYW1lKCk7Il0sIm5hbWVzIjpbIkdhbWVCb2FyZCIsImNvbnN0cnVjdG9yIiwiYm9hcmQiLCJ0aGlzIiwibWlzc2VkIiwiaGl0cyIsImFsbG93IiwibmFtZSIsImluaXRpYWxpemUiLCJjb3VudCIsImkiLCJqIiwicGxhY2VTaGlwIiwic2hpcCIsImNvbHVtbiIsInBvc2l0aW9uIiwibGVuZ3RoIiwiaW5kZXhPZiIsInJlY2lldmVBdHRhY2siLCJwdXNoIiwiYWxsb3dBdHRhY2siLCJpbnN0YW5jZU5hbWUiLCJQbGF5ZXIiLCJ0dXJuIiwiYXV0b1BsYXkiLCJncmlkIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiU2hpcCIsImhpdCIsImhpdFBvc2l0aW9uIiwiYWxsU2hpcFN1bmsiLCJjcmVhdGVCb2FyZCIsIm5ld0JvYXJkIiwiaWQiLCJjbGFzc05hbWUiLCJkaXJlY3Rpb24iLCJjb250YWluZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJmb3JFYWNoIiwiZSIsImRpdiIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJhcHBlbmRDaGlsZCIsInZhbHVlIiwidGV4dENvbnRlbnQiLCJ1cGRhdGVCb2FyZCIsImNvbnRhaW5lcklEIiwiZ3JpZElEIiwicmVtb3ZlQm9hcmQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZWxlbWVudCIsInJlbW92ZUNoaWxkIiwiY2hlY2tJZk91dE9mQm91bmQiLCJldmVudCIsImluY3JlbWVudCIsIm91dE9mQm91bmQ1Iiwib3V0T2ZCb3VuZDQiLCJvdXRPZkJvdW5kMyIsIm91dE9mQm91bmQyIiwiaW5jbHVkZXMiLCJ0YXJnZXQiLCJnZXRDb29yZGluYXRlcyIsImNvbG9yIiwiY29vcmRpbmF0ZSIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwiZmxhZyIsInJvdGF0ZUJ1dHRvbiIsInJlbmRlclBsYXllclNoaXBzIiwiZ2FtZWJvYXJkIiwiYWlCb2FyZCIsImdyaWRzIiwicmVuZGVyQXR0YWNrIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNvbHVtbnMiLCJnZXRDb2x1bW5zIiwiQXJyYXkiLCJmcm9tIiwiZmlsdGVyIiwicGxheWVyQm9hcmQiLCJhaSIsInJhbmRvbWx5UGlja2VkR3JpZCIsImdyaWRWYWx1ZSIsInBsYXllckdyaWRzIiwiZWxlbWVudFZhbHVlIiwiY2hlY2tJZldvbiIsInJlbmRlckFpQXR0YWNrIiwiRXZlbnQiLCJkaXNwYXRjaEV2ZW50IiwiYm9hcmROYW1lIiwid2lubmVyQ29udGFpbmVyIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJIVE1MQnV0dG9uRWxlbWVudCIsImxvY2F0aW9uIiwicmVsb2FkIiwic2hpcDIiLCJzaGlwMyIsInNoaXA0Iiwic2hpcDUiLCJyZW5kZXJBaVNoaXBzIiwicnVuR2FtZSJdLCJzb3VyY2VSb290IjoiIn0=