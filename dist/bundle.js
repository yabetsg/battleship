(()=>{"use strict";class t{constructor(t,e,i){this.length=t,this.hits=[],this.position=i||[],this.column=e||[]}hit(t){this.position.includes(t)&&!this.hits.includes(t)&&this.hits.push(t)}isSunk(){return this.length===this.hits.length}}const e=(t,e,i,o)=>{const r=document.querySelector(e);t.initialize(),t.board.forEach((t=>{t.forEach((t=>{const e=document.createElement("div");e.classList.add(i),e.classList.add(o),e.setAttribute("value",t),r.appendChild(e),e.value=t,e.textContent=t}))}))},i=(t,e,i,r)=>{o(e,i);const s=document.querySelector(`#${e}`);t.board.forEach((t=>{t.forEach((t=>{const e=document.createElement("div");e.classList.add(i),e.classList.add(r),e.setAttribute("value",t),s.appendChild(e),e.value=t,e.textContent=t}))}))},o=(t,e)=>{const i=document.querySelector(`#${t}`);document.querySelectorAll(`.${e}`).forEach((t=>{i.removeChild(t)}))},r=(t,e,i,o)=>{let r=[];if(1!==t.length){for(let s=0;s<=(t.length-1)*o;s+=o){if(e.target.value+s=="x0")return;if(null===document.querySelector(`div[value="${e.target.value+s}"]`))return;if(e.target.value+s=="x0")return void console.log("event:"+e.target.value+s);document.querySelector(`div[value="${e.target.value+s}"]`).style.backgroundColor=i,r.push(e.target.value+s)}return r}};let s=!0,n="horizontal",l=1;const a=document.querySelector("#rotate"),c=(e,o)=>{let a=document.querySelectorAll(`#primary-container>.${n}`);const h=new t(o,[0,0,0],[1,2,3]);3===o&&s&&(o+=1,s=!1),o<=0||(a.forEach((t=>t.addEventListener("mouseover",(s=>{r(h,s,"blue",l),t.addEventListener("click",(t=>{h.position=r(h,t,"gray",l),h.column=(t=>{let e=[];for(let i=0;i<=t.length-1;i++)console.log(t.position[i]),null!=t.position[i]&&e.push(Math.floor(t.position[i]/10));return e})(h),e.placeShip(h),i(e,"primary-container","player-grids",n),Array.from(document.querySelectorAll(".player-grids")).filter((t=>"x"===t.value)).forEach((t=>t.style.backgroundColor="transparent")),c(e,o-1)}))})))),a.forEach((t=>t.addEventListener("mouseout",(t=>{r(h,t,"gray",l)})))))};a.addEventListener("click",(t=>{"horizontal"===n?(n="vertical",l=10,console.log("inside h")):"vertical"===n&&(n="horizontal",l=1)}));class h{constructor(t){this.board=t||[],this.missed=[[]],this.hits=[[]]}initialize(){let t=0;for(let e=0;e<10;e++){this.board[e]=[];for(let i=0;i<10;i++)this.board[e][i]=t,t++}}placeShip(t){let e=t.column,i=t.position;for(let t=0;t<i.length;t++)for(let o=0;o<i.length;o++)this.board[e[t]][this.board[e[t]].indexOf(i[o])]="x"}recieveAttack(t,e){"x"===this.board[t][e]?void 0===this.hits[t]?this.hits[t]=[e]:this.hits[t].push(e):void 0===this.missed[t]?this.missed[t]=[e]:this.missed[t].push(e)}}class u{constructor(){this.turn=!0,this.position=this.position}autoPlay(){return Math.floor(10*Math.random())}}(()=>{new u,new u;const o=new h,r=new h;e(o,"#primary-container","player-grids","horizontal"),e(r,"#secondary-container","ai-grids","horizontal"),c(o,5),(e=>{const o=new t(5,[0,0,0,0,0],[1,2,3,4,5]),r=new t(4,[7,7,7,7],[73,74,75,76]),s=new t(3,[2,2,2],[22,23,24]),n=new t(3,[4,4,4],[44,45,46]),l=new t(2,[8,9],[81,91]);e.placeShip(o),e.placeShip(r),e.placeShip(s),e.placeShip(n),e.placeShip(l),i(e,"secondary-container","ai-grids")})(r)})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxFQUFZaUUsRUFBUSx1QkFBdUIsV0FBVyxjQUNyRHhCLEVBQWtCdUIsRUFBWSxHSG1MTCxDQUFDdEIsSUFDM0IsTUFBTWQsRUFBTyxJQUFJeEMsRUFBSyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxHQUFHLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxJQUN2QzhFLEVBQVEsSUFBSTlFLEVBQUssRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEdBQUcsQ0FBQyxHQUFHLEdBQUcsR0FBRyxLQUN2QytFLEVBQVEsSUFBSS9FLEVBQUssRUFBRSxDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsR0FBRyxHQUFHLEtBQ2xDZ0YsRUFBUSxJQUFJaEYsRUFBSyxFQUFFLENBQUMsRUFBRSxFQUFFLEdBQUcsQ0FBQyxHQUFHLEdBQUcsS0FDbENpRixFQUFRLElBQUlqRixFQUFLLEVBQUUsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxHQUFHLEtBRW5Dc0QsRUFBVU8sVUFBVXJCLEdBQ3BCYyxFQUFVTyxVQUFVaUIsR0FDcEJ4QixFQUFVTyxVQUFVa0IsR0FDcEJ6QixFQUFVTyxVQUFVbUIsR0FDcEIxQixFQUFVTyxVQUFVb0IsR0FDcEJqRCxFQUFZc0IsRUFBVSxzQkFBc0IsV0FBVyxFRzlMdkQ0QixDQUFjTCxFQUFRLEVBZTFCTSxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9mYWN0b3JpZXMvU2hpcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3NjcmlwdHMvZG9tLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZmFjdG9yaWVzL0dhbWVCb2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2ZhY3Rvcmllcy9QbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9zY3JpcHRzL21haW4uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2hpcHtcbiAgICBjb25zdHJ1Y3RvcihsZW5ndGgsY29sdW1uLHBvc2l0aW9uKXtcbiAgICAgICAgdGhpcy5sZW5ndGggPSBsZW5ndGg7XG4gICAgICAgIHRoaXMuaGl0cyA9IFtdO1xuICAgICAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb258fFtdO1xuICAgICAgICB0aGlzLmNvbHVtbiA9IGNvbHVtbnx8W107XG4gICAgICAgXG4gICAgfVxuICAgIGhpdChoaXRQb3NpdGlvbil7XG4gICAgICAgIGlmKHRoaXMucG9zaXRpb24uaW5jbHVkZXMoaGl0UG9zaXRpb24pJiYgISh0aGlzLmhpdHMuaW5jbHVkZXMoaGl0UG9zaXRpb24pKSl7XG4gICAgICAgICAgICB0aGlzLmhpdHMucHVzaChoaXRQb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfVxuXG4gICAgaXNTdW5rKCl7XG4gICAgICAgIGlmKHRoaXMubGVuZ3RoID09PSB0aGlzLmhpdHMubGVuZ3RoKXtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG5cbiIsImltcG9ydCBHYW1lQm9hcmQgZnJvbSBcIi4uL2ZhY3Rvcmllcy9HYW1lQm9hcmRcIjtcbmltcG9ydCBTaGlwIGZyb20gXCIuLi9mYWN0b3JpZXMvU2hpcFwiO1xuXG5cbi8vIFRPRE86IEZpeCBzaGlwIGlzc3VlIHdoZXJlIHNoaXAgcGxhY2VtZW50IG92ZXJsYXBcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZUJvYXJkID0gKG5ld0JvYXJkLGlkLGNsYXNzTmFtZSxkaXJlY3Rpb24pPT57XG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihpZCk7XG4gICAgbmV3Qm9hcmQuaW5pdGlhbGl6ZSgpO1xuICAgIGxldCBib2FyZCA9IG5ld0JvYXJkLmJvYXJkO1xuICAgIGJvYXJkLmZvckVhY2goZT0+e1xuICAgICAgICBlLmZvckVhY2goZT0+e1xuICAgICAgICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpOyBcbiAgICAgICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKGRpcmVjdGlvbik7IFxuICAgICAgICAgICAgZGl2LnNldEF0dHJpYnV0ZSgndmFsdWUnLGUpO1xuICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGRpdik7XG4gICAgICAgICAgICBkaXYudmFsdWUgPSBlO1xuICAgICAgICAgICAgZGl2LnRleHRDb250ZW50ID0gZTtcbiAgICAgICAgICAgIFxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydCBjb25zdCB1cGRhdGVCb2FyZCA9IChuZXdCb2FyZCxjb250YWluZXJJRCxncmlkSUQsZGlyZWN0aW9uKT0+e1xuICAgIHJlbW92ZUJvYXJkKGNvbnRhaW5lcklELGdyaWRJRCk7XG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7Y29udGFpbmVySUR9YCk7XG4gICAgbGV0IGJvYXJkID0gbmV3Qm9hcmQuYm9hcmQ7XG4gICAgYm9hcmQuZm9yRWFjaChlPT57XG4gICAgICAgIGUuZm9yRWFjaChlPT57XG4gICAgICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKGdyaWRJRCk7IFxuICAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZChkaXJlY3Rpb24pOyBcbiAgICAgICAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJyxlKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChkaXYpO1xuICAgICAgICAgICAgZGl2LnZhbHVlID0gZTtcbiAgICAgICAgICAgIGRpdi50ZXh0Q29udGVudCA9IGU7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIFxuICAgICAgICB9KTtcbiAgICAgICAgIFxuICAgIH0pO1xuXG4gICAgXG59XG5leHBvcnQgY29uc3QgcmVtb3ZlQm9hcmQgPSAoY29udGFpbmVySUQsZ3JpZElEKT0+e1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2NvbnRhaW5lcklEfWApO1xuICAgIGNvbnN0IGdyaWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAuJHtncmlkSUR9YCk7XG4gICAgZ3JpZC5mb3JFYWNoKGVsZW1lbnQ9PiB7IFxuICAgICAgICAgICAgXG4gICAgICAgICBjb250YWluZXIucmVtb3ZlQ2hpbGQoZWxlbWVudClcbiAgICAgIFxuICAgICAgIFxuICAgIH0pO1xufVxuZXhwb3J0IGNvbnN0IGNsaWNrRXZlbnQgPSAocGxheWVyLGFpKT0+e1xuICAgIGNvbnN0IGdyaWRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmdyaWRzJyk7XG4gICAgZ3JpZHMuZm9yRWFjaChlbGVtZW50PT5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSk9PntcbiAgICAgICAgaWYocGxheWVyLnR1cm4pe1xuICAgICAgICAgICAgIGFpLnR1cm4gPSB0cnVlO1xuICAgICAgICAgICAgIHBsYXllci50dXJuID0gZmFsc2U7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdwbGF5ZXI6ICcrZS50YXJnZXQudmFsdWUpO1xuICAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEV2ZW50KCdjbGljaycpO1xuICAgICAgICAgICAgZWxlbWVudC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICAgICAgfWVsc2UgaWYoYWkudHVybil7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnYWk6ICcrIGFpLmF1dG9QbGF5KCkpO1xuICAgICAgICAgICAgYWkudHVybiA9IGZhbHNlO1xuICAgICAgICAgICAgcGxheWVyLnR1cm4gPSB0cnVlO1xuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfSkpO1xufVxuY29uc3QgZ2V0Q29vcmRpbmF0ZXMgPSAoc2hpcCxldmVudCxjb2xvcixpbmNyZW1lbnQpPT57XG4gICAgXG4gICAgbGV0IGNvb3JkaW5hdGUgPSBbXTtcbiAgICBpZihzaGlwLmxlbmd0aD09PTEpe1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGZvcihsZXQgaT0wO2k8PShzaGlwLmxlbmd0aC0xKSppbmNyZW1lbnQ7aT1pK2luY3JlbWVudCl7IFxuICAgICAgICAgXG4gICAgICAgIGlmKGV2ZW50LnRhcmdldC52YWx1ZStpPT0neDAnKXtcbiAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgZGl2W3ZhbHVlPVwiJHtldmVudC50YXJnZXQudmFsdWUraX1cIl1gKT09PW51bGwpe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9ZWxzZSBpZigoZXZlbnQudGFyZ2V0LnZhbHVlK2kpPT0neDAnKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdldmVudDonK2V2ZW50LnRhcmdldC52YWx1ZStpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIFxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBkaXZbdmFsdWU9XCIke2V2ZW50LnRhcmdldC52YWx1ZStpfVwiXWApLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yO1xuICAgICAgICBjb29yZGluYXRlLnB1c2goZXZlbnQudGFyZ2V0LnZhbHVlK2kpO1xuICAgICAgICBcbiAgICAgICBcbiAgICB9XG4gICAgcmV0dXJuIGNvb3JkaW5hdGU7XG59XG5jb25zdCBnZXRDb2x1bW5zID0gKHNoaXApPT57XG4gICAgbGV0IGNvbHVtbnMgPSBbXTtcbiAgICBmb3IobGV0IGkgPSAwOyBpPD1zaGlwLmxlbmd0aC0xOyBpKyspe1xuICAgICAgICBjb25zb2xlLmxvZyhzaGlwLnBvc2l0aW9uW2ldKTtcbiAgICAgICAgaWYoc2hpcC5wb3NpdGlvbltpXSE9bnVsbCl7XG4gICAgICAgICAgICAgY29sdW1ucy5wdXNoKE1hdGguZmxvb3IoKHNoaXAucG9zaXRpb25baV0pLzEwKSk7XG4gICAgICAgIH1cblxuICAgICAgIFxuICAgIH1cbiAgXG4gICAgcmV0dXJuIGNvbHVtbnM7XG59XG5jb25zdCBjaGFuZ2VDb2xvciA9ICgpID0+e1xuICAgIGNvbnN0IHNlbGVjdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBsYXllci1ncmlkcycpKTtcbiAgICBzZWxlY3QuZmlsdGVyKGVsZW1lbnQ9PmVsZW1lbnQudmFsdWU9PT0neCcpLmZvckVhY2goZWxlbWVudD0+ZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndHJhbnNwYXJlbnQnKTtcbiAgICBcbiAgICBcbn1cbmxldCBmbGFnID0gdHJ1ZTtcbiBsZXQgZGlyZWN0aW9uID0gJ2hvcml6b250YWwnO1xuIGxldCBpbmNyZW1lbnQgPSAxO1xuIGNvbnN0IHJvdGF0ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNyb3RhdGUnKTtcblxuZXhwb3J0IGNvbnN0IHJlbmRlclBsYXllclNoaXBzID0gIChnYW1lYm9hcmQsbGVuZ3RoKSA9PntcbiAgICBcbiAgIFxuICAgIGxldCBncmlkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYCNwcmltYXJ5LWNvbnRhaW5lcj4uJHtkaXJlY3Rpb259YCk7XG4gICAgXG4gICAgXG4gICAgY29uc3Qgc2hpcCA9IG5ldyBTaGlwKGxlbmd0aCxbMCwwLDBdLFsxLDIsM10pO1xuICAgIFxuICAgIGlmKGxlbmd0aD09PTMpe1xuICAgICAgICBpZihmbGFnKXtcbiAgICAgICAgICAgbGVuZ3RoKz0xOyBcbiAgICAgICAgICAgZmxhZz1mYWxzZTtcbiAgICAgICAgfSBcbiAgICB9XG4gICAgaWYobGVuZ3RoPD0wKXtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBcbiAgICBncmlkcy5mb3JFYWNoKGVsZW1lbnQ9PmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywoZSk9PntcbiAgICAgICAgICAgIGdldENvb3JkaW5hdGVzKHNoaXAsZSwnYmx1ZScsaW5jcmVtZW50KTtcbiAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKGUpPT57XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgc2hpcC5wb3NpdGlvbiA9IGdldENvb3JkaW5hdGVzKHNoaXAsZSwnZ3JheScsaW5jcmVtZW50KTtcbiAgICAgICAgICAgICAgIHNoaXAuY29sdW1uID0gZ2V0Q29sdW1ucyhzaGlwKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgZ2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwKTtcbiAgICAgICAgICAgICAgICAgdXBkYXRlQm9hcmQoZ2FtZWJvYXJkLCdwcmltYXJ5LWNvbnRhaW5lcicsXCJwbGF5ZXItZ3JpZHNcIixkaXJlY3Rpb24pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgY2hhbmdlQ29sb3IoKTtcbiAgICAgICAgICAgICAgICAgcmVuZGVyUGxheWVyU2hpcHMoZ2FtZWJvYXJkLGxlbmd0aC0xKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICBcbiAgICAgICAgXG4gICAgICAgICAgIFxuICAgICAgICAgIFxuICAgIH0pKTtcbiAgICBcblxuICAgIGdyaWRzLmZvckVhY2goZWxlbWVudD0+ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsKGUpPT57XG4gICAgICAgIGdldENvb3JkaW5hdGVzKHNoaXAsZSwnZ3JheScsaW5jcmVtZW50KTtcbiAgICB9KSk7ICBcbiAgICBcbiAgIFxuICAgXG59XG5cbiByb3RhdGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLChlKT0+e1xuICAgICAgXG4gICAgICAgIGlmKGRpcmVjdGlvbiA9PT0naG9yaXpvbnRhbCcpe1xuICAgICAgICAgICAgZGlyZWN0aW9uID0gJ3ZlcnRpY2FsJztcbiAgICAgICAgICAgIGluY3JlbWVudCA9IDEwO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnaW5zaWRlIGgnKTtcbiAgICAgICAgfWVsc2UgaWYoZGlyZWN0aW9uID09PSd2ZXJ0aWNhbCcpe1xuICAgICAgICAgICAgZGlyZWN0aW9uID0gJ2hvcml6b250YWwnO1xuICAgICAgICAgICAgaW5jcmVtZW50ID0gMTtcbiAgICAgICAgICAgXG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgXG4gICAgfSk7XG5cblxuXG5cblxuZXhwb3J0IGNvbnN0IHJlbmRlckFpU2hpcHMgPSAgKGdhbWVib2FyZCkgPT57XG4gICAgY29uc3Qgc2hpcCA9IG5ldyBTaGlwKDUsWzAsMCwwLDAsMF0sWzEsMiwzLDQsNV0pO1xuICAgIGNvbnN0IHNoaXAyID0gbmV3IFNoaXAoNCxbNyw3LDcsN10sWzczLDc0LDc1LDc2XSk7XG4gICAgY29uc3Qgc2hpcDMgPSBuZXcgU2hpcCgzLFsyLDIsMl0sWzIyLDIzLDI0XSk7XG4gICAgY29uc3Qgc2hpcDQgPSBuZXcgU2hpcCgzLFs0LDQsNF0sWzQ0LDQ1LDQ2XSk7XG4gICAgY29uc3Qgc2hpcDUgPSBuZXcgU2hpcCgyLFs4LDldLFs4MSw5MV0pO1xuICAgIFxuICAgIGdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcCk7XG4gICAgZ2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwMik7XG4gICAgZ2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwMyk7XG4gICAgZ2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwNCk7XG4gICAgZ2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwNSk7XG4gICAgdXBkYXRlQm9hcmQoZ2FtZWJvYXJkLCdzZWNvbmRhcnktY29udGFpbmVyJyxcImFpLWdyaWRzXCIpO1xufVxuXG5cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbWVCb2FyZCB7XG4gIGNvbnN0cnVjdG9yKGJvYXJkKSB7XG4gICAgdGhpcy5ib2FyZCA9IGJvYXJkIHx8IFtdO1xuICAgIHRoaXMubWlzc2VkID0gW1tdXTtcbiAgICB0aGlzLmhpdHMgPSBbW11dO1xuICB9XG5cbiAgaW5pdGlhbGl6ZSgpIHtcbiAgICBsZXQgY291bnQgPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgdGhpcy5ib2FyZFtpXSA9IFtdO1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgIHRoaXMuYm9hcmRbaV1bal0gPSBjb3VudDtcbiAgICAgICAgY291bnQrKztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwbGFjZVNoaXAoc2hpcCkge1xuICAgIGxldCBjb2x1bW4gPSBzaGlwLmNvbHVtbjtcbiAgICBsZXQgcG9zaXRpb24gPSBzaGlwLnBvc2l0aW9uO1xuICAgIGZvcihsZXQgaT0wOyBpPHBvc2l0aW9uLmxlbmd0aDtpKyspe1xuICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgcG9zaXRpb24ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgdGhpcy5ib2FyZFtjb2x1bW5baV1dW3RoaXMuYm9hcmRbY29sdW1uW2ldXS5pbmRleE9mKHBvc2l0aW9uW2pdKV0gPSAneCc7XG4gICAgICBcbiAgICB9XG4gICAgfVxuICAgXG4gICAgXG4gIH1cblxuICByZWNpZXZlQXR0YWNrKGNvbHVtbiwgcG9zaXRpb24pIHtcbiAgICBpZiAodGhpcy5ib2FyZFtjb2x1bW5dW3Bvc2l0aW9uXSA9PT0gXCJ4XCIpIHtcbiAgICAgIGlmICh0aGlzLmhpdHNbY29sdW1uXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRoaXMuaGl0c1tjb2x1bW5dID0gW3Bvc2l0aW9uXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuaGl0c1tjb2x1bW5dLnB1c2gocG9zaXRpb24pO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodGhpcy5taXNzZWRbY29sdW1uXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLm1pc3NlZFtjb2x1bW5dID0gW3Bvc2l0aW9uXTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5taXNzZWRbY29sdW1uXS5wdXNoKHBvc2l0aW9uKTtcbiAgICB9XG4gIH1cbiBcbn1cbiIsImV4cG9ydCBjbGFzcyBQbGF5ZXJ7XG4gICAgY29uc3RydWN0b3IoKXsgXG4gICAgICAgIHRoaXMudHVybiA9IHRydWU7XG4gICAgICAgIHRoaXMucG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uO1xuICAgIH1cbiAgXG4gICAgYXV0b1BsYXkoKXtcbiAgICAgICAgbGV0IHJhbmRvbSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSoxMCk7XG4gICAgICAgIHJldHVybiByYW5kb207XG4gICAgfVxufSIsImltcG9ydCBHYW1lQm9hcmQgZnJvbSBcIi4uL2ZhY3Rvcmllcy9HYW1lQm9hcmRcIjtcbmltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuLi9mYWN0b3JpZXMvUGxheWVyXCJcbmltcG9ydCBTaGlwIGZyb20gXCIuLi9mYWN0b3JpZXMvU2hpcFwiO1xuaW1wb3J0IHsgY2xpY2tFdmVudCwgY3JlYXRlQm9hcmQsIHJlbW92ZUJvYXJkLCByZW5kZXJBaVNoaXBzLCByZW5kZXJQbGF5ZXJTaGlwcywgdXBkYXRlQm9hcmQgfSBmcm9tIFwiLi9kb21cIjtcblxuZXhwb3J0IGNvbnN0IHJ1bkdhbWUgPSAoKT0+e1xuICAgIGNvbnN0IHBsYXllciA9IG5ldyBQbGF5ZXIoKTtcbiAgICBjb25zdCBhaSA9IG5ldyBQbGF5ZXIoKTtcbiAgICBjb25zdCBwbGF5ZXJCb2FyZCA9IG5ldyBHYW1lQm9hcmQoKTtcbiAgICBjb25zdCBhaUJvYXJkID0gbmV3IEdhbWVCb2FyZCgpO1xuICAgIFxuICAgIGNyZWF0ZUJvYXJkKHBsYXllckJvYXJkLCcjcHJpbWFyeS1jb250YWluZXInLCdwbGF5ZXItZ3JpZHMnLCdob3Jpem9udGFsJyk7XG4gICAgY3JlYXRlQm9hcmQoYWlCb2FyZCwnI3NlY29uZGFyeS1jb250YWluZXInLCdhaS1ncmlkcycsJ2hvcml6b250YWwnKTtcbiAgICAgcmVuZGVyUGxheWVyU2hpcHMocGxheWVyQm9hcmQsNSk7IFxuICAgIHJlbmRlckFpU2hpcHMoYWlCb2FyZCk7XG4gICAgLy8gcmVuZGVyU2hpcHMoZ2FtZWJvYXJkLDQpO1xuICAgLy8gdXBkYXRlQm9hcmQoZ2FtZWJvYXJkLCdwcmltYXJ5LWNvbnRhaW5lcicsXCJwbGF5ZXItZ3JpZHNcIik7XG4gICAgIFxuICAgIC8vIGZvcihsZXQgaSA9MDtpPDQ7IGkrKyl7XG4gICAgICAgXG4gICAgLy8gICAgIHJlbmRlclNoaXBzKGdhbWVib2FyZCw0KTtcbiAgICAvLyB9XG4gICAgIFxuICAgIFxuXG4gICBcbiAgICAvLyAgY29uc29sZS5sb2coZ2FtZWJvYXJkLmJvYXJkKTtcbiAgICAvLyAgY2xpY2tFdmVudChwbGF5ZXIsYWkpO1xufVxucnVuR2FtZSgpOyJdLCJuYW1lcyI6WyJTaGlwIiwiY29uc3RydWN0b3IiLCJsZW5ndGgiLCJjb2x1bW4iLCJwb3NpdGlvbiIsInRoaXMiLCJoaXRzIiwiaGl0IiwiaGl0UG9zaXRpb24iLCJpbmNsdWRlcyIsInB1c2giLCJpc1N1bmsiLCJjcmVhdGVCb2FyZCIsIm5ld0JvYXJkIiwiaWQiLCJjbGFzc05hbWUiLCJkaXJlY3Rpb24iLCJjb250YWluZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpbml0aWFsaXplIiwiYm9hcmQiLCJmb3JFYWNoIiwiZSIsImRpdiIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJhcHBlbmRDaGlsZCIsInZhbHVlIiwidGV4dENvbnRlbnQiLCJ1cGRhdGVCb2FyZCIsImNvbnRhaW5lcklEIiwiZ3JpZElEIiwicmVtb3ZlQm9hcmQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZWxlbWVudCIsInJlbW92ZUNoaWxkIiwiZ2V0Q29vcmRpbmF0ZXMiLCJzaGlwIiwiZXZlbnQiLCJjb2xvciIsImluY3JlbWVudCIsImNvb3JkaW5hdGUiLCJpIiwidGFyZ2V0IiwiY29uc29sZSIsImxvZyIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwiZmxhZyIsInJvdGF0ZUJ1dHRvbiIsInJlbmRlclBsYXllclNoaXBzIiwiZ2FtZWJvYXJkIiwiZ3JpZHMiLCJhZGRFdmVudExpc3RlbmVyIiwiY29sdW1ucyIsIk1hdGgiLCJmbG9vciIsImdldENvbHVtbnMiLCJwbGFjZVNoaXAiLCJBcnJheSIsImZyb20iLCJmaWx0ZXIiLCJHYW1lQm9hcmQiLCJtaXNzZWQiLCJjb3VudCIsImoiLCJpbmRleE9mIiwicmVjaWV2ZUF0dGFjayIsInVuZGVmaW5lZCIsIlBsYXllciIsInR1cm4iLCJhdXRvUGxheSIsInJhbmRvbSIsInBsYXllckJvYXJkIiwiYWlCb2FyZCIsInNoaXAyIiwic2hpcDMiLCJzaGlwNCIsInNoaXA1IiwicmVuZGVyQWlTaGlwcyIsInJ1bkdhbWUiXSwic291cmNlUm9vdCI6IiJ9