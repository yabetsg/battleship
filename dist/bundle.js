(()=>{"use strict";class e{constructor(e){this.board=e||[],this.missed=[[]],this.hits=[],this.allow=!1}initialize(e){for(let t=0;t<10;t++){this.board[t]=[];for(let r=0;r<10;r++)this.board[t][r]=e,e++}}placeShip(e){let t=e.column,r=e.position;for(let e=0;e<r.length;e++)for(let o=0;o<r.length;o++)this.board[t[e]][this.board[t[e]].indexOf(r[o])]="x"}recieveAttack(e){this.hits.push(e)}allowAttack(){return this.allow}}class t{constructor(){this.turn=!0,this.position=this.position}autoPlay(e){return e[Math.floor(100*Math.random())]}}class r{constructor(e,t,r){this.length=e,this.hits=[],this.position=r||[],this.column=t||[]}hit(e){this.hits.push(e)}isSunk(){return this.length===this.hits.length}}const o=(e,t,r,o)=>{const l=document.querySelector(t);e.board.forEach((e=>{e.forEach((e=>{const t=document.createElement("div");t.classList.add(r),t.classList.add(o),t.setAttribute("value",e),l.appendChild(t),t.value=e,t.textContent=e}))}))},l=(e,t,r,o)=>{n(t,r);const l=document.querySelector(`#${t}`);e.board.forEach((e=>{e.forEach((e=>{const t=document.createElement("div");t.classList.add(r),t.classList.add(o),t.setAttribute("value",e),l.appendChild(t),t.value=e,t.textContent=e}))}))},n=(e,t)=>{const r=document.querySelector(`#${e}`);document.querySelectorAll(`.${t}`).forEach((e=>{r.removeChild(e)}))},a=(e,t,r)=>{let o=[6,7,8,9],l=[7,8,9],n=[8,9],a=[9];if(1===r)switch(!0){case 5===e.length&&o.includes(t.target.value%10):case 4===e.length&&l.includes(t.target.value%10):case 3===e.length&&n.includes(t.target.value%10):case 2===e.length&&a.includes(t.target.value%10):return!0}if(10===r)switch(!0){case 5===e.length&&o.includes(Math.floor(t.target.value/10)):case 4===e.length&&l.includes(Math.floor(t.target.value/10)):case 3===e.length&&n.includes(Math.floor(t.target.value/10)):case 2===e.length&&a.includes(Math.floor(t.target.value/10)):return!0}},i=(e,t,r,o)=>{let l=[];if(1!==e.length){for(let n=0;n<=(e.length-1)*o;n+=o){if(a(e,t,o))return;if(5===e.length&&t.target.value%10==6)return;if(t.target.value+n=="x0")return;if(null===document.querySelector(`div[value="${t.target.value+n}"]`))return;if(t.target.value+n=="x0")return;document.querySelector(`div[value="${t.target.value+n}"]`).style.backgroundColor=r,l.push(t.target.value+n)}return l}};let c=!0,s="horizontal",u=1;const h=document.querySelector("#rotate"),d=(e,t,o)=>{let n=document.querySelectorAll(`.player-grids.${s}`);const a=new r(t,[0,0,0],[1,2,3]);if(3===t&&c&&(t+=1,c=!1),t<=1)return console.log("am i ever here????"),void g(e);n.forEach((r=>r.addEventListener("mouseover",(n=>{i(a,n,"blue",u),r.addEventListener("click",(r=>{console.log(o),a.position=i(a,r,"gray",u),a.column=(e=>{let t=[];for(let r=0;r<=e.length-1;r++)e.position[r]&&t.push(Math.floor(e.position[r]/10));return t})(a),e.placeShip(a),l(e,"primary-container","player-grids",s),Array.from(document.querySelectorAll(".player-grids")).filter((e=>"x"===e.value)).forEach((e=>e.style.backgroundColor="transparent")),d(e,t-1)}))})))),n.forEach((e=>e.addEventListener("mouseout",(e=>{i(a,e,"gray",u)}))))},g=r=>{let o,l,n,a=new e;const i=document.querySelectorAll(".player-grids");document.querySelectorAll(".ai-grids").forEach((e=>e.addEventListener("click",(c=>{const s=c.target.value;o=new t,l=o.autoPlay(i),n=l.value,"x"===s?(a.recieveAttack(s),p(a),e.style.backgroundColor="red",v(l,n,r),console.log("hits:"+a.hits.length)):(e.style.backgroundColor="green",v(l,n,r))}))))},v=(e,t,r)=>{e.addEventListener("click",(o=>{const l=o.target.value;"x"===t?(r.recieveAttack(t),p(r),e.style.backgroundColor="red",r.recieveAttack(l),console.log("ai red")):e.style.backgroundColor="green"}));const o=new Event("click");e.dispatchEvent(o)};h.addEventListener("click",(e=>{"horizontal"===s?(s="vertical",u=10):"vertical"===s&&(s="horizontal",u=1)}));const p=e=>{17===e.hits.length&&console.log("player won!")};(()=>{new t,new t;const n=new e,a=new e;n.initialize(0),a.initialize(100),o(n,"#primary-container","player-grids","horizontal"),o(a,"#secondary-container","ai-grids","horizontal"),(e=>{const t=new r(5,[0,0,0,0,0],[101,102,103,104,105]),o=new r(4,[7,7,7,7],[173,174,175,176]),n=new r(3,[2,2,2],[122,123,124]),a=new r(3,[4,4,4],[144,145,146]),i=new r(2,[8,9],[181,191]);e.placeShip(t),l(e,"secondary-container","ai-grids","horizontal"),e.placeShip(o),l(e,"secondary-container","ai-grids","horizontal"),e.placeShip(n),l(e,"secondary-container","ai-grids","horizontal"),e.placeShip(a),l(e,"secondary-container","ai-grids","horizontal"),e.placeShip(i),l(e,"secondary-container","ai-grids","horizontal")})(a),d(n,5,a)})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUl2RSxFQUFLLEVBQUUsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxJQUFJLE1BRXBDOEMsRUFBVTlELFVBQVVDLEdBQ3BCcUMsRUFBWXdCLEVBQVUsc0JBQXNCLFdBQVcsY0FDdkRBLEVBQVU5RCxVQUFVb0YsR0FDcEI5QyxFQUFZd0IsRUFBVSxzQkFBc0IsV0FBVyxjQUN2REEsRUFBVTlELFVBQVVxRixHQUNwQi9DLEVBQVl3QixFQUFVLHNCQUFzQixXQUFXLGNBQ3ZEQSxFQUFVOUQsVUFBVXNGLEdBQ3BCaEQsRUFBWXdCLEVBQVUsc0JBQXNCLFdBQVcsY0FDdkRBLEVBQVU5RCxVQUFVdUYsR0FDcEJqRCxFQUFZd0IsRUFBVSxzQkFBc0IsV0FBVyxhQUFhLEVDaFVwRTBCLENBQWN6QixHQUVkRixFQUFrQmEsRUFBWSxFQUFFWCxFQUFRLEVBcUI1QzBCLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2ZhY3Rvcmllcy9HYW1lQm9hcmQuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9mYWN0b3JpZXMvUGxheWVyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZmFjdG9yaWVzL1NoaXAuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9zY3JpcHRzL2RvbS5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3NjcmlwdHMvbWFpbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lQm9hcmQge1xuICBjb25zdHJ1Y3Rvcihib2FyZCkge1xuICAgIHRoaXMuYm9hcmQgPSBib2FyZCB8fCBbXTtcbiAgICB0aGlzLm1pc3NlZCA9IFtbXV07XG4gICAgdGhpcy5oaXRzID0gW107XG4gICAgdGhpcy5hbGxvdyA9IGZhbHNlO1xuICB9XG5cbiAgaW5pdGlhbGl6ZShjb3VudCkge1xuICAgIFxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgdGhpcy5ib2FyZFtpXSA9IFtdO1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgIHRoaXMuYm9hcmRbaV1bal0gPSBjb3VudDtcbiAgICAgICAgY291bnQrKztcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgXG5cblxuICBwbGFjZVNoaXAoc2hpcCkge1xuICAgIGxldCBjb2x1bW4gPSBzaGlwLmNvbHVtbjtcbiAgICBsZXQgcG9zaXRpb24gPSBzaGlwLnBvc2l0aW9uO1xuICAgIFxuICAgXG4gICAgZm9yKGxldCBpPTA7IGk8cG9zaXRpb24ubGVuZ3RoO2krKyl7XG4gICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBwb3NpdGlvbi5sZW5ndGg7IGorKykge1xuICAgICAgICAvLyBpZigodGhpcy5ib2FyZFtjb2x1bW5baV0rMV1bdGhpcy5ib2FyZFtjb2x1bW5baV0rMV0uaW5kZXhPZihwb3NpdGlvbltqXSsxMCldKSE9J3gnKXtcbiAgICAgICAgICB0aGlzLmJvYXJkW2NvbHVtbltpXV1bdGhpcy5ib2FyZFtjb2x1bW5baV1dLmluZGV4T2YocG9zaXRpb25bal0pXSA9ICd4JztcbiAgICAgICAgXG4gICAgICAgIC8vIH1cbiAgICB9XG4gICB9XG4gICBcbiAgfVxuICBcbiBcbiAgXG4gIHJlY2lldmVBdHRhY2socG9zaXRpb24pe1xuICAgIFxuICAgICAgICB0aGlzLmhpdHMucHVzaChwb3NpdGlvbik7XG4gICAgXG4gIH1cblxuICBhbGxvd0F0dGFjaygpe1xuICAgIHJldHVybiB0aGlzLmFsbG93O1xuICB9XG5cbiAgLy8gcmVjaWV2ZUF0dGFjayhjb2x1bW4sIHBvc2l0aW9uKSB7XG4gIC8vICAgZm9yKGxldCBpPTA7IGk8cG9zaXRpb24ubGVuZ3RoOyBpKyspe1xuICAvLyAgICAgZm9yKGxldCBqPTA7IGo8cG9zaXRpb24ubGVuZ3RoOyBqKyspe1xuICAvLyAgICAgICBpZiAodGhpcy5ib2FyZFtjb2x1bW5baV1dW3Bvc2l0aW9uW2pdXSA9PT0gXCJ4XCIpIHtcbiAgLy8gICAgICAgICBpZiAodGhpcy5oaXRzW2NvbHVtbltpXV0gPT09IHVuZGVmaW5lZCkge1xuICAvLyAgICAgICB0aGlzLmhpdHNbY29sdW1uW2ldXSA9IFtwb3NpdGlvbltqXV07XG4gIC8vICAgICB9IGVsc2Uge1xuICAvLyAgICAgICB0aGlzLmhpdHNbY29sdW1uW2ldXS5wdXNoKHBvc2l0aW9uW2ldKTtcbiAgLy8gICAgIH1cbiAgLy8gICB9IGVsc2UgaWYgKHRoaXMubWlzc2VkW2NvbHVtbl0gPT09IHVuZGVmaW5lZCkge1xuICAvLyAgICAgdGhpcy5taXNzZWRbY29sdW1uXSA9IFtwb3NpdGlvbl07XG4gIC8vICAgfSBlbHNlIHtcbiAgLy8gICAgIHRoaXMubWlzc2VkW2NvbHVtbl0ucHVzaChwb3NpdGlvbik7XG4gIC8vICAgfVxuICAvLyAgICAgfVxuICAvLyAgIH1cbiAgICBcbiAgLy8gfVxuIFxufVxuIiwiZXhwb3J0IGNsYXNzIFBsYXllcntcbiAgICBjb25zdHJ1Y3RvcigpeyBcbiAgICAgICAgdGhpcy50dXJuID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHRoaXMucG9zaXRpb247XG4gICAgfVxuICBcbiAgICBhdXRvUGxheShncmlkKXtcbiAgICAgICAgXG4gICAgICAgIGxldCByYW5kb20gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMTAwKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBncmlkW3JhbmRvbV07XG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNoaXB7XG4gICAgY29uc3RydWN0b3IobGVuZ3RoLGNvbHVtbixwb3NpdGlvbil7XG4gICAgICAgIHRoaXMubGVuZ3RoID0gbGVuZ3RoO1xuICAgICAgICB0aGlzLmhpdHMgPSBbXTtcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHBvc2l0aW9ufHxbXTtcbiAgICAgICAgdGhpcy5jb2x1bW4gPSBjb2x1bW58fFtdO1xuICAgICAgIFxuICAgIH1cbiAgICBoaXQoaGl0UG9zaXRpb24pe1xuICAgICAgICAvLyBpZih0aGlzLnBvc2l0aW9uLmluY2x1ZGVzKGhpdFBvc2l0aW9uKSYmICEodGhpcy5oaXRzLmluY2x1ZGVzKGhpdFBvc2l0aW9uKSkpe1xuICAgICAgICAgICAgdGhpcy5oaXRzLnB1c2goaGl0UG9zaXRpb24pO1xuICAgICAgICAvL31cbiAgICAgICAgXG4gICAgfVxuXG4gICAgaXNTdW5rKCl7XG4gICAgICAgIGlmKHRoaXMubGVuZ3RoID09PSB0aGlzLmhpdHMubGVuZ3RoKXtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG5cbiIsImltcG9ydCBHYW1lQm9hcmQgZnJvbSBcIi4uL2ZhY3Rvcmllcy9HYW1lQm9hcmRcIjtcbmltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuLi9mYWN0b3JpZXMvUGxheWVyXCI7XG5pbXBvcnQgU2hpcCBmcm9tIFwiLi4vZmFjdG9yaWVzL1NoaXBcIjtcblxuXG4vLyBUT0RPOiBXaW5uaW5nIGNvbmRpdGlvblxuXG5leHBvcnQgY29uc3QgY3JlYXRlQm9hcmQgPSAobmV3Qm9hcmQsaWQsY2xhc3NOYW1lLGRpcmVjdGlvbik9PntcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGlkKTtcbiAgICBcbiAgICBsZXQgYm9hcmQgPSBuZXdCb2FyZC5ib2FyZDtcbiAgICBcbiAgICBib2FyZC5mb3JFYWNoKGU9PntcbiAgICAgICAgZS5mb3JFYWNoKGU9PntcbiAgICAgICAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTsgXG4gICAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZChkaXJlY3Rpb24pOyBcbiAgICAgICAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJyxlKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChkaXYpO1xuICAgICAgICAgICAgZGl2LnZhbHVlID0gZTtcbiAgICAgICAgICAgIGRpdi50ZXh0Q29udGVudCA9IGU7XG4gICAgICAgICAgICBcbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG5leHBvcnQgY29uc3QgdXBkYXRlQm9hcmQgPSAobmV3Qm9hcmQsY29udGFpbmVySUQsZ3JpZElELGRpcmVjdGlvbik9PntcbiAgICByZW1vdmVCb2FyZChjb250YWluZXJJRCxncmlkSUQpO1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2NvbnRhaW5lcklEfWApO1xuICAgIGxldCBib2FyZCA9IG5ld0JvYXJkLmJvYXJkO1xuICAgIGJvYXJkLmZvckVhY2goZT0+e1xuICAgICAgICBlLmZvckVhY2goZT0+e1xuICAgICAgICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZChncmlkSUQpOyBcbiAgICAgICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoZGlyZWN0aW9uKTsgXG4gICAgICAgICAgICBkaXYuc2V0QXR0cmlidXRlKCd2YWx1ZScsZSk7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoZGl2KTtcbiAgICAgICAgICAgIGRpdi52YWx1ZSA9IGU7XG4gICAgICAgICAgICBkaXYudGV4dENvbnRlbnQgPSBlO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBcbiAgICAgICAgfSk7XG4gICAgICAgICBcbiAgICB9KTtcblxuICAgIFxufVxuZXhwb3J0IGNvbnN0IHJlbW92ZUJvYXJkID0gKGNvbnRhaW5lcklELGdyaWRJRCk9PntcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtjb250YWluZXJJRH1gKTtcbiAgICBjb25zdCBncmlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLiR7Z3JpZElEfWApO1xuICAgIGdyaWQuZm9yRWFjaChlbGVtZW50PT4geyBcbiAgICAgICAgICAgIFxuICAgICAgICAgY29udGFpbmVyLnJlbW92ZUNoaWxkKGVsZW1lbnQpXG4gICAgICBcbiAgICAgICBcbiAgICB9KTtcbn1cbmV4cG9ydCBjb25zdCBjbGlja0V2ZW50ID0gKHBsYXllcixhaSk9PntcbiAgICBjb25zdCBncmlkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5ncmlkcycpO1xuICAgIGdyaWRzLmZvckVhY2goZWxlbWVudD0+ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKGUpPT57XG4gICAgICAgIGlmKHBsYXllci50dXJuKXtcbiAgICAgICAgICAgICBhaS50dXJuID0gdHJ1ZTtcbiAgICAgICAgICAgICBwbGF5ZXIudHVybiA9IGZhbHNlO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zb2xlLmxvZygncGxheWVyOiAnK2UudGFyZ2V0LnZhbHVlKTtcbiAgICAgICAgICAgICBjb25zdCBldmVudCA9IG5ldyBFdmVudCgnY2xpY2snKTtcbiAgICAgICAgICAgIGVsZW1lbnQuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgIH1lbHNlIGlmKGFpLnR1cm4pe1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2FpOiAnKyBhaS5hdXRvUGxheSgpKTtcbiAgICAgICAgICAgIGFpLnR1cm4gPSBmYWxzZTtcbiAgICAgICAgICAgIHBsYXllci50dXJuID0gdHJ1ZTtcbiAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIFxuICAgIH0pKTtcbn1cblxuY29uc3QgY2hlY2tJZk91dE9mQm91bmQgPSAoc2hpcCxldmVudCxpbmNyZW1lbnQpPT57XG4gICAgbGV0IG91dE9mQm91bmQ1ID0gWzYsNyw4LDldO1xuICAgICBsZXQgb3V0T2ZCb3VuZDQgPSBbNyw4LDldO1xuICAgICBsZXQgb3V0T2ZCb3VuZDMgPSBbOCw5XTtcbiAgICAgbGV0IG91dE9mQm91bmQyID0gWzldO1xuICAgIFxuICAgIGlmKGluY3JlbWVudCA9PT0xKXtcbiAgICAgICAgc3dpdGNoKHRydWUpeyBcbiAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09NSAmJiBvdXRPZkJvdW5kNS5pbmNsdWRlcyhldmVudC50YXJnZXQudmFsdWUlMTApOlxuICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09NCAmJiBvdXRPZkJvdW5kNC5pbmNsdWRlcyhldmVudC50YXJnZXQudmFsdWUlMTApOlxuICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09MyAmJiBvdXRPZkJvdW5kMy5pbmNsdWRlcyhldmVudC50YXJnZXQudmFsdWUlMTApOlxuICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09MiAmJiBvdXRPZkJvdW5kMi5pbmNsdWRlcyhldmVudC50YXJnZXQudmFsdWUlMTApOlxuICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gXG4gICAgIH1cbiAgICAgaWYoaW5jcmVtZW50ID09PTEwKXtcbiAgICAgICAgIHN3aXRjaCh0cnVlKXsgXG4gICAgICAgICAgICAgIGNhc2Ugc2hpcC5sZW5ndGg9PT01ICYmIG91dE9mQm91bmQ1LmluY2x1ZGVzKE1hdGguZmxvb3IoZXZlbnQudGFyZ2V0LnZhbHVlLzEwKSk6XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgY2FzZSBzaGlwLmxlbmd0aD09PTQgJiYgb3V0T2ZCb3VuZDQuaW5jbHVkZXMoTWF0aC5mbG9vcihldmVudC50YXJnZXQudmFsdWUvMTApKTpcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICBjYXNlIHNoaXAubGVuZ3RoPT09MyAmJiBvdXRPZkJvdW5kMy5pbmNsdWRlcyhNYXRoLmZsb29yKGV2ZW50LnRhcmdldC52YWx1ZS8xMCkpOlxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgIGNhc2Ugc2hpcC5sZW5ndGg9PT0yICYmIG91dE9mQm91bmQyLmluY2x1ZGVzKE1hdGguZmxvb3IoZXZlbnQudGFyZ2V0LnZhbHVlLzEwKSk6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgIH0gXG4gICAgICB9XG59XG5jb25zdCBnZXRDb29yZGluYXRlcyA9IChzaGlwLGV2ZW50LGNvbG9yLGluY3JlbWVudCk9PntcbiAgXG5cbiAgbGV0IGNvb3JkaW5hdGUgPSBbXTtcbiAgaWYgKHNoaXAubGVuZ3RoID09PSAxKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGZvciAobGV0IGkgPSAwOyBpIDw9IChzaGlwLmxlbmd0aCAtIDEpICogaW5jcmVtZW50OyBpID0gaSArIGluY3JlbWVudCkge1xuICAgICBpZihjaGVja0lmT3V0T2ZCb3VuZChzaGlwLGV2ZW50LGluY3JlbWVudCkpIHJldHVybjtcbiAgIFxuICAgIGlmIChzaGlwLmxlbmd0aCA9PT0gNSkge1xuICAgICAgaWYgKGV2ZW50LnRhcmdldC52YWx1ZSAlIDEwID09PSA2KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV2ZW50LnRhcmdldC52YWx1ZSArIGkgPT0gXCJ4MFwiKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYGRpdlt2YWx1ZT1cIiR7ZXZlbnQudGFyZ2V0LnZhbHVlICsgaX1cIl1gKSA9PT0gbnVsbFxuICAgICkge1xuICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlICsgaSA9PSBcIngwXCIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYGRpdlt2YWx1ZT1cIiR7ZXZlbnQudGFyZ2V0LnZhbHVlICsgaX1cIl1gXG4gICAgKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcjtcbiAgICBjb29yZGluYXRlLnB1c2goZXZlbnQudGFyZ2V0LnZhbHVlICsgaSk7XG4gIH1cbiAgcmV0dXJuIGNvb3JkaW5hdGU7XG59XG5jb25zdCBnZXRDb2x1bW5zID0gKHNoaXApPT57XG4gICAgbGV0IGNvbHVtbnMgPSBbXTtcbiAgICBmb3IobGV0IGkgPSAwOyBpPD1zaGlwLmxlbmd0aC0xOyBpKyspe1xuICAgICAgICBcbiAgICAgICAgICBpZihzaGlwLnBvc2l0aW9uW2ldKXtcbiAgICAgICAgICAgICBjb2x1bW5zLnB1c2goTWF0aC5mbG9vcigoc2hpcC5wb3NpdGlvbltpXSkvMTApKTtcbiAgICAgICAgfSAgXG4gICAgICAgIFxuICAgICAgIFxuICAgIH1cbiAgXG4gICAgcmV0dXJuIGNvbHVtbnM7XG59XG5jb25zdCBjaGFuZ2VDb2xvciA9ICgpID0+e1xuICAgIGNvbnN0IHNlbGVjdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBsYXllci1ncmlkcycpKTtcbiAgICBzZWxlY3QuZmlsdGVyKGVsZW1lbnQ9PmVsZW1lbnQudmFsdWU9PT0neCcpLmZvckVhY2goZWxlbWVudD0+ZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndHJhbnNwYXJlbnQnKTtcbiAgICBcbiAgICBcbn1cbmxldCBmbGFnID0gdHJ1ZTtcbiBsZXQgZGlyZWN0aW9uID0gJ2hvcml6b250YWwnO1xuIGxldCBpbmNyZW1lbnQgPSAxO1xuIGNvbnN0IHJvdGF0ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNyb3RhdGUnKTtcblxuZXhwb3J0IGNvbnN0IHJlbmRlclBsYXllclNoaXBzID0gICAoZ2FtZWJvYXJkLGxlbmd0aCxhaUJvYXJkKSA9PntcbiAgICAgXG4gICAgXG4gICAgXG4gICAgbGV0IGdyaWRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLnBsYXllci1ncmlkcy4ke2RpcmVjdGlvbn1gKTtcbiAgICBcbiAgICBcbiAgICBjb25zdCBzaGlwID0gbmV3IFNoaXAobGVuZ3RoLFswLDAsMF0sWzEsMiwzXSk7XG4gICAgXG4gICAgaWYobGVuZ3RoPT09Myl7XG4gICAgICAgIGlmKGZsYWcpe1xuICAgICAgICAgICBsZW5ndGgrPTE7IFxuICAgICAgICAgICBmbGFnPWZhbHNlO1xuICAgICAgICB9IFxuICAgIH1cbiAgICBpZihsZW5ndGg8PTEpe1xuICAgICAgICBjb25zb2xlLmxvZygnYW0gaSBldmVyIGhlcmU/Pz8/Jyk7XG4gICAgICAgIC8vY29uc29sZS5sb2coZ2FtZWJvYXJkKTtcbiAgICAgIFxuICAgICAgICAvLyAgbGV0IGFpSGl0cyA9IHJlbmRlckF0dGFjayhnYW1lYm9hcmQpLmFpQm9hcmQuaGl0cy5sZW5ndGg7XG4gICAgICAgIC8vIGlmKGFpSGl0cyA9PT0gNSl7XG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZygncGxheWVyIHdvbicpO1xuICAgICAgICAvLyB9XG4gICAgICAgcmVuZGVyQXR0YWNrKGdhbWVib2FyZCk7XG4gICAgICBcbiAgICAgIC8vIGNvbnNvbGUubG9nKCdhaUhpdHM6JythaUhpdHMpO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAgXG4gICAgZ3JpZHMuZm9yRWFjaChlbGVtZW50PT5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsKGUpPT57XG4gICAgICAgICAgICAgZ2V0Q29vcmRpbmF0ZXMoc2hpcCxlLCdibHVlJyxpbmNyZW1lbnQpO1xuICAgICAgICAgICAgIFxuICAgICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSk9PntcbiAgICAgICAgICAgICAgIC8vIHJlbmRlckFpU2hpcHMoYWlCb2FyZClcbiAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGFpQm9hcmQpO1xuICAgICAgICAgICAgICAgc2hpcC5wb3NpdGlvbiA9IGdldENvb3JkaW5hdGVzKHNoaXAsZSwnZ3JheScsaW5jcmVtZW50KTtcbiAgICAgICAgICAgICAgIHNoaXAuY29sdW1uID0gZ2V0Q29sdW1ucyhzaGlwKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgZ2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwKTtcbiAgICAgICAgICAgICAgICAgdXBkYXRlQm9hcmQoZ2FtZWJvYXJkLCdwcmltYXJ5LWNvbnRhaW5lcicsXCJwbGF5ZXItZ3JpZHNcIixkaXJlY3Rpb24pO1xuICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICBjaGFuZ2VDb2xvcigpO1xuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJlbmRlclBsYXllclNoaXBzKGdhbWVib2FyZCxsZW5ndGgtMSk7XG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgIFxuICAgIH0pKTtcbiAgICBcblxuICAgIGdyaWRzLmZvckVhY2goZWxlbWVudD0+ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsKGUpPT57XG4gICAgICAgIGdldENvb3JkaW5hdGVzKHNoaXAsZSwnZ3JheScsaW5jcmVtZW50KTtcbiAgICB9KSk7ICBcbiAgICBcbiAgIFxuICAgXG59XG5cblxuZXhwb3J0IGNvbnN0IHJlbmRlckF0dGFjayA9IChwbGF5ZXJCb2FyZCkgPT57XG4gICBsZXQgYWlCb2FyZCA9IG5ldyBHYW1lQm9hcmQoKTtcbiAgICBsZXQgYWk7XG4gICAgbGV0IHJhbmRvbWx5UGlja2VkR3JpZDtcbiAgICBsZXQgZ3JpZFZhbHVlO1xuICAgIGNvbnN0IHBsYXllckdyaWRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBsYXllci1ncmlkcycpO1xuICAgIGNvbnN0IGFpR3JpZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYWktZ3JpZHMnKTtcbiAgIFxuICAgIFxuICAgIFxuICAgICAgICBcbiAgICAgICAgYWlHcmlkcy5mb3JFYWNoKGVsZW1lbnQ9PmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLChlKT0+e1xuICAgICAgICAgICAgICBjb25zdCBlbGVtZW50VmFsdWUgPSBlLnRhcmdldC52YWx1ZTtcbiAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnZWxlbWVudDonK2VsZW1lbnRWYWx1ZSk7XG4gICAgICAgICAgICAgIGFpID0gbmV3IFBsYXllcigpO1xuICAgICAgICAgICAgICByYW5kb21seVBpY2tlZEdyaWQgPSBhaS5hdXRvUGxheShwbGF5ZXJHcmlkcyk7XG4gICAgICAgICAgICAgIGdyaWRWYWx1ZSA9IHJhbmRvbWx5UGlja2VkR3JpZC52YWx1ZTtcbiAgICAgICAgICAgICBcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYoZWxlbWVudFZhbHVlID09PSAneCcpe1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGFpQm9hcmQucmVjaWV2ZUF0dGFjayhlbGVtZW50VmFsdWUpO1xuICAgICAgICAgICAgICAgIGNoZWNrSWZXb24oYWlCb2FyZCk7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmVkJztcbiAgICAgICAgICAgICAgICByZW5kZXJBaUF0dGFjayhyYW5kb21seVBpY2tlZEdyaWQsZ3JpZFZhbHVlLHBsYXllckJvYXJkKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnaGl0czonKyBhaUJvYXJkLmhpdHMubGVuZ3RoKTtcbiAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdncmVlbic7XG4gICAgICAgICAgICAgICAgcmVuZGVyQWlBdHRhY2socmFuZG9tbHlQaWNrZWRHcmlkLGdyaWRWYWx1ZSxwbGF5ZXJCb2FyZCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgfSkpO1xuICAgICAgICBcbiAgICAgICAgXG4gICAgXG4gICAgfVxuY29uc3QgcmVuZGVyQWlBdHRhY2sgPSAocmFuZG9tbHlQaWNrZWRHcmlkLGdyaWRWYWx1ZSxwbGF5ZXJCb2FyZCk9PntcbiAgICByYW5kb21seVBpY2tlZEdyaWQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLChlKT0+e1xuICAgICAgICBjb25zdCBlbGVtZW50VmFsdWUgPSBlLnRhcmdldC52YWx1ZTtcbiAgICAgICAgaWYoZ3JpZFZhbHVlPT09ICd4Jyl7XG4gICAgICAgICAgICBwbGF5ZXJCb2FyZC5yZWNpZXZlQXR0YWNrKGdyaWRWYWx1ZSk7XG4gICAgICAgICAgICBjaGVja0lmV29uKHBsYXllckJvYXJkKTtcbiAgICAgICAgICAgIHJhbmRvbWx5UGlja2VkR3JpZC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmVkJztcbiAgICAgICAgICAgIHBsYXllckJvYXJkLnJlY2lldmVBdHRhY2soZWxlbWVudFZhbHVlKVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2FpIHJlZCcpO1xuXG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICBcbiAgICAgICAgICAgICByYW5kb21seVBpY2tlZEdyaWQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2dyZWVuJztcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2cocmFuZG9tbHlQaWNrZWRHcmlkKTtcbiAgICAgICAgfVxuICAgICB9KTtcbiAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEV2ZW50KCdjbGljaycpO1xuICAgICByYW5kb21seVBpY2tlZEdyaWQuZGlzcGF0Y2hFdmVudChldmVudCk7XG59XG5cbmV4cG9ydCBjb25zdCByZW5kZXJQbGF5ZXJBdHRhY2sgPSAoYm9hcmQpPT57XG4gICAgY29uc3QgYWlHcmlkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5haS1ncmlkcycpO1xuICAgIGFpR3JpZHMuZm9yRWFjaChlbGVtZW50PT5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSk9PntcbiAgICAgICAgaWYoZS50YXJnZXQudmFsdWUgPT09ICd4Jyl7XG4gICAgICAgICAgICBib2FyZC5yZWNpZXZlQXR0YWNrKGUudGFyZ2V0LnZhbHVlKTtcbiAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3JlZCc7XG4gICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2dyZWVuJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9KSk7XG59XG5cbiByb3RhdGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLChlKT0+e1xuICAgICAgXG4gICAgICAgIGlmKGRpcmVjdGlvbiA9PT0naG9yaXpvbnRhbCcpe1xuICAgICAgICAgICAgZGlyZWN0aW9uID0gJ3ZlcnRpY2FsJztcbiAgICAgICAgICAgIGluY3JlbWVudCA9IDEwO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBcbiAgICAgICAgfWVsc2UgaWYoZGlyZWN0aW9uID09PSd2ZXJ0aWNhbCcpe1xuICAgICAgICAgICAgZGlyZWN0aW9uID0gJ2hvcml6b250YWwnO1xuICAgICAgICAgICAgaW5jcmVtZW50ID0gMTtcbiAgICAgICAgICAgXG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgXG4gICAgfSk7XG5cblxuY29uc3QgY2hlY2tJZldvbiA9IChib2FyZCk9PntcbiAgICBpZihib2FyZC5oaXRzLmxlbmd0aCA9PT0xNyl7XG4gICAgICAgIGNvbnNvbGUubG9nKCdwbGF5ZXIgd29uIScpO1xuICAgICAgfVxufVxuXG5cbmV4cG9ydCBjb25zdCByZW5kZXJBaVNoaXBzID0gIChnYW1lYm9hcmQpID0+e1xuICAgIGNvbnN0IHNoaXAgPSBuZXcgU2hpcCg1LFswLDAsMCwwLDBdLFsxMDEsMTAyLDEwMywxMDQsMTA1XSk7XG4gICAgY29uc3Qgc2hpcDIgPSBuZXcgU2hpcCg0LFs3LDcsNyw3XSxbMTczLDE3NCwxNzUsMTc2XSk7XG4gICAgY29uc3Qgc2hpcDMgPSBuZXcgU2hpcCgzLFsyLDIsMl0sWzEyMiwxMjMsMTI0XSk7XG4gICAgY29uc3Qgc2hpcDQgPSBuZXcgU2hpcCgzLFs0LDQsNF0sWzE0NCwxNDUsMTQ2XSk7XG4gICAgY29uc3Qgc2hpcDUgPSBuZXcgU2hpcCgyLFs4LDldLFsxODEsMTkxXSk7XG4gICAgXG4gICAgZ2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwKTtcbiAgICB1cGRhdGVCb2FyZChnYW1lYm9hcmQsJ3NlY29uZGFyeS1jb250YWluZXInLFwiYWktZ3JpZHNcIixcImhvcml6b250YWxcIik7XG4gICAgZ2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwMik7XG4gICAgdXBkYXRlQm9hcmQoZ2FtZWJvYXJkLCdzZWNvbmRhcnktY29udGFpbmVyJyxcImFpLWdyaWRzXCIsXCJob3Jpem9udGFsXCIpO1xuICAgIGdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcDMpO1xuICAgIHVwZGF0ZUJvYXJkKGdhbWVib2FyZCwnc2Vjb25kYXJ5LWNvbnRhaW5lcicsXCJhaS1ncmlkc1wiLFwiaG9yaXpvbnRhbFwiKTtcbiAgICBnYW1lYm9hcmQucGxhY2VTaGlwKHNoaXA0KTtcbiAgICB1cGRhdGVCb2FyZChnYW1lYm9hcmQsJ3NlY29uZGFyeS1jb250YWluZXInLFwiYWktZ3JpZHNcIixcImhvcml6b250YWxcIik7XG4gICAgZ2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwNSk7XG4gICAgdXBkYXRlQm9hcmQoZ2FtZWJvYXJkLCdzZWNvbmRhcnktY29udGFpbmVyJyxcImFpLWdyaWRzXCIsXCJob3Jpem9udGFsXCIpO1xuICAgIFxufVxuXG5cblxuIiwiaW1wb3J0IEdhbWVCb2FyZCBmcm9tIFwiLi4vZmFjdG9yaWVzL0dhbWVCb2FyZFwiO1xuaW1wb3J0IHsgUGxheWVyIH0gZnJvbSBcIi4uL2ZhY3Rvcmllcy9QbGF5ZXJcIlxuaW1wb3J0IFNoaXAgZnJvbSBcIi4uL2ZhY3Rvcmllcy9TaGlwXCI7XG5pbXBvcnQgeyBjbGlja0V2ZW50LCBjcmVhdGVCb2FyZCwgcmVtb3ZlQm9hcmQsIHJlbmRlckFpU2hpcHMsIHJlbmRlckF0dGFjaywgcmVuZGVyUGxheWVyU2hpcHMsIHVwZGF0ZUJvYXJkICwgcmVuZGVyQWlBdHRhY2t9IGZyb20gXCIuL2RvbVwiO1xuXG5leHBvcnQgY29uc3QgcnVuR2FtZSA9ICgpPT57XG4gICAgY29uc3QgcGxheWVyID0gbmV3IFBsYXllcigpO1xuICAgIGNvbnN0IGFpID0gbmV3IFBsYXllcigpO1xuICAgXG5cbiAgICBjb25zdCBwbGF5ZXJCb2FyZCA9IG5ldyBHYW1lQm9hcmQoKTtcbiAgICBjb25zdCBhaUJvYXJkID0gbmV3IEdhbWVCb2FyZCgpO1xuICAgIHBsYXllckJvYXJkLmluaXRpYWxpemUoMCk7XG4gICAgYWlCb2FyZC5pbml0aWFsaXplKDEwMCk7XG4gICAgXG4gICAgY3JlYXRlQm9hcmQocGxheWVyQm9hcmQsJyNwcmltYXJ5LWNvbnRhaW5lcicsJ3BsYXllci1ncmlkcycsJ2hvcml6b250YWwnKTtcbiAgICBjcmVhdGVCb2FyZChhaUJvYXJkLCcjc2Vjb25kYXJ5LWNvbnRhaW5lcicsJ2FpLWdyaWRzJywnaG9yaXpvbnRhbCcpO1xuICAgIC8vY29uc29sZS5sb2coYWlCb2FyZCk7XG4gICAgcmVuZGVyQWlTaGlwcyhhaUJvYXJkKTtcbiAgICAvL2NvbnNvbGUubG9nKGFpQm9hcmQpO1xuICAgIHJlbmRlclBsYXllclNoaXBzKHBsYXllckJvYXJkLDUsYWlCb2FyZCk7IFxuICAvLyAgY29uc29sZS5sb2coYWlCb2FyZCk7XG4gICAgICAgXG4gICAgLy8gIHJlbmRlckF0dGFjayhhaUJvYXJkLHBsYXllckJvYXJkKTtcbiAgICBcbiAgIFxuICAgIFxuICAgIC8vIHJlbmRlclNoaXBzKGdhbWVib2FyZCw0KTtcbiAgIC8vIHVwZGF0ZUJvYXJkKGdhbWVib2FyZCwncHJpbWFyeS1jb250YWluZXInLFwicGxheWVyLWdyaWRzXCIpO1xuICAgICBcbiAgICAvLyBmb3IobGV0IGkgPTA7aTw0OyBpKyspe1xuICAgICAgIFxuICAgIC8vICAgICByZW5kZXJTaGlwcyhnYW1lYm9hcmQsNCk7XG4gICAgLy8gfVxuICAgICBcbiAgICBcblxuICAgXG4gICAgLy8gIGNvbnNvbGUubG9nKGdhbWVib2FyZC5ib2FyZCk7XG4gICAgLy8gIGNsaWNrRXZlbnQocGxheWVyLGFpKTtcbn1cbnJ1bkdhbWUoKTsiXSwibmFtZXMiOlsiR2FtZUJvYXJkIiwiY29uc3RydWN0b3IiLCJib2FyZCIsInRoaXMiLCJtaXNzZWQiLCJoaXRzIiwiYWxsb3ciLCJpbml0aWFsaXplIiwiY291bnQiLCJpIiwiaiIsInBsYWNlU2hpcCIsInNoaXAiLCJjb2x1bW4iLCJwb3NpdGlvbiIsImxlbmd0aCIsImluZGV4T2YiLCJyZWNpZXZlQXR0YWNrIiwicHVzaCIsImFsbG93QXR0YWNrIiwiUGxheWVyIiwidHVybiIsImF1dG9QbGF5IiwiZ3JpZCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsIlNoaXAiLCJoaXQiLCJoaXRQb3NpdGlvbiIsImlzU3VuayIsImNyZWF0ZUJvYXJkIiwibmV3Qm9hcmQiLCJpZCIsImNsYXNzTmFtZSIsImRpcmVjdGlvbiIsImNvbnRhaW5lciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImZvckVhY2giLCJlIiwiZGl2IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsInNldEF0dHJpYnV0ZSIsImFwcGVuZENoaWxkIiwidmFsdWUiLCJ0ZXh0Q29udGVudCIsInVwZGF0ZUJvYXJkIiwiY29udGFpbmVySUQiLCJncmlkSUQiLCJyZW1vdmVCb2FyZCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlbGVtZW50IiwicmVtb3ZlQ2hpbGQiLCJjaGVja0lmT3V0T2ZCb3VuZCIsImV2ZW50IiwiaW5jcmVtZW50Iiwib3V0T2ZCb3VuZDUiLCJvdXRPZkJvdW5kNCIsIm91dE9mQm91bmQzIiwib3V0T2ZCb3VuZDIiLCJpbmNsdWRlcyIsInRhcmdldCIsImdldENvb3JkaW5hdGVzIiwiY29sb3IiLCJjb29yZGluYXRlIiwic3R5bGUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJmbGFnIiwicm90YXRlQnV0dG9uIiwicmVuZGVyUGxheWVyU2hpcHMiLCJnYW1lYm9hcmQiLCJhaUJvYXJkIiwiZ3JpZHMiLCJjb25zb2xlIiwibG9nIiwicmVuZGVyQXR0YWNrIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNvbHVtbnMiLCJnZXRDb2x1bW5zIiwiQXJyYXkiLCJmcm9tIiwiZmlsdGVyIiwicGxheWVyQm9hcmQiLCJhaSIsInJhbmRvbWx5UGlja2VkR3JpZCIsImdyaWRWYWx1ZSIsInBsYXllckdyaWRzIiwiZWxlbWVudFZhbHVlIiwiY2hlY2tJZldvbiIsInJlbmRlckFpQXR0YWNrIiwiRXZlbnQiLCJkaXNwYXRjaEV2ZW50Iiwic2hpcDIiLCJzaGlwMyIsInNoaXA0Iiwic2hpcDUiLCJyZW5kZXJBaVNoaXBzIiwicnVuR2FtZSJdLCJzb3VyY2VSb290IjoiIn0=